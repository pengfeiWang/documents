/*! ============================================= 
    project: shouxinMFW  
    version: 0.1.1 
    update: 2015-05-03 
    author: pengfeiWang 
==================================================  */
;if(!window.$$$||typeof($$$)!=="function"){var $$$=(function(n,l){var u=n.document,B=Object.prototype,t=B.toString,h=[],c=h.indexOf,v=h.slice,A=h.splice,k=h.concat,y={},f=/[^, ]+/g,r=/\S+/g,b=u.createDocumentFragment(),d=(typeof(MSApp)==="object"),g={columncount:!0,fontweight:!0,lineheight:!0,"column-count":!0,"font-weight":!0,"line-height":!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,"z-index":!0,zoom:!0};function m(D,C){return(typeof(C)==="number")&&!g[D.toLowerCase()]?C+"px":C}function q(D,F){var E=0,C=this.length;if(F){for(;E<C;E++){this[E][D]=F}return this}else{return this[0][D]}}function o(D){var F=[];for(var E=0,C=D.length;E<C;E++){if(F.indexOf(D[E])==-1){F.push(D[E])}}return F}function s(F,H,G){if(!F){return}var I=b.cloneNode(false);var E=/^(script)$/i;var C=F.length;if(F.nodeType==11){F=F.children}if(F){if(typeof F=="string"){I.innerHTML=F}else{for(var D=0;D<C;D++){if(F[D].nodeType===1){I.appendChild(F[D])}}}if(H){H.appendChild(I)}else{return I}}I=null}function e(D,G,F){if(!D){return G}if(D.nodeType){G[G.length++]=D;return G}if(F!==l){for(var E=0,C=D.length;E<C;E++){if(F.test(D[E].className)){G[G.length++]=D[E]}}}else{for(var E=0,C=D.length;E<C;E++){G[G.length++]=D[E]}}return G}function z(E,H){var I=(j.isIns(H)?H[0]:H)||u,G,D,C,F;var J=this;if(/^\d+/.test(E)){return}if(j.isWindow(J)||j.isEmptyObject(J)){J={length:0}}if(typeof E=="string"){E=E.trim();if(E[0]==="<"&&E[E.length-1]===">"&&E.length>=3&&E.indexOf(">")===E.length-1){var G=u.createElement("div");G.innerHTML=E.trim();return e(G.childNodes,J)}else{switch(E[0]){case"#":var D=u.getElementById(E.substring(1));break;case".":var D=I.getElementsByTagName("*"),F=new RegExp("(^|\\s)"+E.substring(1)+"(\\s|$)");break;default:var D=I.getElementsByTagName(E)}return e(D,J,F)}}else{if(j.isIns(E)&&H==l){return E}else{if(j.isFunction(E)){return j(u).ready(E)}else{if(j.isArray(E)&&E.length!==l){return e(E,J)}else{if(j.isHTMLCollection(E)&&E.length>0){j.each(E,function(K,L){J[J.length++]=L})}else{if((j.isDocument(E)||j.isWindow(n))&&H==l){J[J.length++]=E;return J}else{if(E.nodeType==11){j.each(E.children,function(K,L){J[J.length++]=L});return J}else{if(E.nodeType==1){J[J.length++]=E;return J}}}}}}}}}var w={prev:function(C){return C.previousElementSibling},next:function(C){return C.nextElementSibling},first:function(C){return C.firstElementChild},last:function(C){return C.lastElementChild}};var p=function(C,D){if(!C){return this}return z.call(this,C,D)};var j=function(C,D){return new p(C,D)};j.uuid=function(){var C=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(C()+C()+"-"+C()+"-"+C()+"-"+C()+"-"+C()+C()+C())};j.cache={eventCache:{},guid:1,Name:"_mobile",elemOldStatus:{},getGid:function(C){return C["__$gid"+j.cache.Name]||(C["__$gid"+j.cache.Name]=j.cache.guid++)}};j.isIns=function(C){return(C instanceof p)};j.unique=o;j.isFunction=function(C){return t.call(C)==="[object Function]"};j.isArray=Array.isArray;j.inArray=function(C,D){if(!j.isArray(C)){return false}return C.indexOf(D)>-1?true:false};j.toArray=function(C){if(j.isArray(C)){return C}return v.call(C)};j.isWindow=function(C){return C!=null&&C==C.window};j.isDocument=function(C){return !!C&&C.nodeType==C.DOCUMENT_NODE};j.isHTMLCollection=function(C){return(t.call(C)==="[object HTMLCollection]"||t.call(C)==="[object NodeList]")};j.isObject=function(C){return t.call(C)==="[object Object]"};j.isPlainObject=function(C){return C&&typeof C==="object"&&Object.getPrototypeOf(C)===B};j.isEmptyObject=function(D){var C;if(!j.isObject(D)){return true}for(C in D){return false}return true};j.proxy=function(D,E,C){return function(){if(C){return D.apply(E,C)}return D.apply(E,arguments)}};j.param=function(D){var H,G=[],E=/%20/g,I=function(J,K){K=j.isFunction(K)?K():(K==null?"":K);G[G.length]=encodeURIComponent(J)+"="+encodeURIComponent(K)};if(j.isArray(D)){for(var F=0,C=D.length;F<C;F++){I(F,D[F])}}else{for(H in D){j.buildParams(H,D[H],I)}}return G.join("&").replace(E,"+")};j.buildParams=function(F,H,G){var D,I=/\[\]$/;if(j.isArray(H)){for(var E=0,C=H.length;E<C;E++){if(I.test(F)){G(F,H[E])}else{j.buildParams(F+"["+(typeof H[E]==="object"?E:"")+"]",H[E],G)}}}else{if(j.isObject(H)){for(D in H){j.buildParams(F+"["+D+"]",H[D],G)}}else{G(F,H)}}};j.frmField=function(F){if(!F||!F.nodeType||F.nodeType!=1){return}var E=[];var D=function(){var I=F.elements;for(var H=0,G=I.length;H<G;H++){if(I[H].name){E.push(I[H])}}};var C=function(){j.each(["input","select","textarea"],function(I,G){var H=z.call(null,G,F);j.each(H,function(J,K){if(K.name){E.push(K)}})})};F.tagName.toLowerCase()=="form"?D():C();return E};j.serialize=function(L){if(!L||!L.nodeType||L.nodeType!=1){return}var M=j.frmField(L),E=0,G=/\[\]$/,C="",D={},K=null,I,F,J=function(S){var O="";var R=[];var Q=S.name;for(var P=0,N=S.options.length;P<N;P++){F=S.options[P];if(F.selected){O=(F.hasAttribute("value")?F.value:F.text);R.push(O)}}if(R.length==1){R=R.join()}return R};D.data={};D.url=L.action;D.type=L.method;for(var E=0,H=M.length;E<H;E++){K=M[E];switch(K.type){case"select-one":case"select-multiple":C=K.name;D.data[C]=J(K);break;case l:case"file":case"submit":case"reset":case"button":break;case"radio":case"checkbox":if(!K.checked){break}default:if(G.test(K.name)){C=K.name.replace(/\[|\]/g,"");if(!D.data[C]){D.data[C]=[]}D.data[C].push(K.value)}else{D.data[K.name]=K.value}}}return D};j.each=function(G,I){if(!G){return G}var D=j.isArray(G),F=j.isIns(G),H,E=0;if(D||F){for(var E=0,C=G.length;E<C;E++){H=I.call(G[E],E,G[E]);if(H===false){break}}}else{for(var E in G){if(E=="length"){continue}if(G.hasOwnProperty(E)){H=I.call(G[E],E,G[E]);if(H===false){break}}}}};j.add=function(G,E){var C=+E.length,D=0,F=G.length;for(;D<C;D++){G[F++]=E[D]}G.length=F;return G};j.extend=function(D){if(D==l){D=this}if(arguments.length==1){for(var C in D){this[C]=D[C]}return this}else{j.each(v.call(arguments,1),function(E,G){for(var F in G){D[F]=G[F]}})}return D};j.fn=p.prototype={namespace:"pengfeiWang",constructor:p,indexOf:c,splice:A,length:0,ready:function(C){if(u.readyState==="complete"||u.readyState==="loaded"){C()}else{u.addEventListener("DOMContentLoaded",C,false)}return this},each:function(C){j.each(this,C);return this},filter:function(E){var I=this.length,K=j.isObject(E),F=E.nodeType;if(!I){return this}if(E==l){return this}if(!K&&F!==1){E=j(E)}var C=[],J=E.length;var H=function(M){for(var L=0;L<J;L++){if(!E[L]||M==E[L]){continue}if(D!==E[L]){C.push(M)}}};for(var G=0;G<I;G++){var D=this[G];if(J){H(D)}else{if(D!==E){C.push(D)}}}return j(o(C))},get:function(E){E=E==l?null:E;var C=this.length;if(E<0){E+=C}if(E===null){var D=[];for(var F=0;F<C;F++){D.push(this[F])}return D}return(this[E])?this[E]:l},find:function(D){var C=this.length;if(!C||!D){return this}var E=[],G;for(var F=0;F<C;F++){E=k.apply(E,v.call(z.call(null,D,this[F])))}return j(o(E))},parent:function(){var C=this.length;if(!C){return this}var D=[];for(var E=0;E<C;E++){D.push(this[E].parentNode)}return j(o(D))},children:function(F){var C=this.length;if(!C){return this}var E=[];if(F){for(var D=0;D<C;D++){E=k.apply(E,v.call(z.call(null,F,this[D])))}}else{for(var D=0;D<C;D++){E=k.apply(E,v.call(this[D].children))}}return j(o(E))},eq:function(C){return j(this[C])},append:function(D){if(!D||D.length==l&&D.length===0){return this}var C=this.length;if(typeof D=="string"){for(var E=0;E<C;E++){s(D,this[E])}}else{for(var E=0;E<C;E++){s(z.call(null,D),this[E])}}return this},before:function(D,F){var C=this.length;if(!C){return this}if(!D){return this}D=s(z.call(null,D));if(D){for(var E=0;E<C;E++){F?this[E].parentNode.insertBefore(D,this[E].nextSibling):this[E].parentNode.insertBefore(D,this[E])}}return this},after:function(C){this.before(C,1);return this},remove:function(D){var C=this.length;if(!C){return}var E=0;if(D){if(typeof D==="string"){for(;E<C;E++){j(D,this[E]).remove()}}}else{var E=C;while(E>0){E--;this[E].parentNode.removeChild(this[E])}}return this},css:function(K,M){var J=this.length;if(!J){return this}var L=j.isDocument(this[0]),F=(typeof K==="string"),I=(M===l&&F),D;if(L||j.isWindow(this[0])){D=K.charAt(0).toUpperCase()+K.slice(1);if(M!==l){return this}return L?this[0].documentElement["offset"+D]:n["inner"+D]}if(I){var E=this[0],C=E.style[K];return C?C:n.getComputedStyle(E,null)[K]}else{if(j.isObject(K)&&!j.isEmptyObject(K)){for(var H=0;H<J;H++){for(var G in K){this[H].style[G]=m(G,K[G])}}}else{for(var H=0;H<J;H++){this[H].style[K]=m(K,M)}}}return this},offset:function(){var C;if(this.length===0){return this}if(j.isWindow(this[0])){return{left:0,top:0,right:0,bottom:0,width:n.innerWidth,height:n.innerHeight}}else{C=this[0].getBoundingClientRect()}return{left:C.left+n.pageXOffset,top:C.top+n.pageYOffset,right:C.right+n.pageXOffset,bottom:C.bottom+n.pageYOffset,width:this.css("width"),height:this.css("height"),outerWidth:C.right-C.left,outerHeight:C.bottom-C.top}},hasClass:function(D){var E=0,C=this.length;for(;E<C;E++){return this[E].nodeType===1&&this[E].classList.contains(D)}},attr:function(C,F){var H=0,J=this.length,G=arguments.length,I=(typeof C==="string"),K=this;var D={name:false,type:false};if(I&&G===1){return this[0].getAttribute(C)}else{if(I&&G===2&&F!==l){for(;H<J;H++){if(D[C]!==false){this[H].setAttribute(C,F)}}}else{if(j.isObject(C)&&!j.isEmptyObject(C)&&j.isPlainObject(C)&&G===1){for(;H<J;H++){for(var E in C){this[H].setAttribute(E,C[E])}}}}}return this},removeAttr:function(F){var G=0,E=0,D=this.length,C=F.match(f),H=C.length;var I={name:false,type:false};for(;G<D;G++){if(this[G].nodeType===1){for(;E<H;E++){if(I[C[E]]!==false){this[G].removeAttribute(C[E])}}}}return this},hasAttr:function(D){var E=0,C=this.length;for(;E<C;E++){if(this[E].nodeType==1&&this[E].hasAttribute(D)){return true}}return false},add:function(C){return j.add(this,C)}};j.each(["width","height"],function(D,C){j.fn[C]=function(E){if(E===l){return this.css(C)}else{this.css(C,E)}return this}});j.each(["outerWidth","outerHeight"],function(D,C){j.fn[C]=function(){return this.offset()[C]+"px"}});j.each({val:"value",html:"innerHTML"},function(D,C){j.fn[D]=function(G){var F=0,E=this.length;if(G!==l){for(;F<E;F++){this[F][C]=G}return this}else{return this[0][C]}}});j.each(w,function(C,D){j.fn[C]=function(){if(this.length===0){return this}var E=D(this[0]);return E?j(E):this}});"add remove".replace(f,function(C){j.fn[C+"Class"]=function(D){var F=this;if(D&&typeof D==="string"){if(D.charAt(0)=="."){D=D.substr(1)}for(var E=0;E<this.length;E++){D.replace(r,function(G){F[E].classList[C](G)})}}return this}});var x=function(C){var E=j.cache.getGid(C);var D;if(!j.cache.elemOldStatus[E]){D=j.cache.elemOldStatus[E]=j.cache.elemOldStatus[E]?j.cache.elemOldStatus[E]:[];D[0]=j(C).css("display")}return E};j.fn.show=function(F){var C=this.length;if(!C){return this}var H,G,D;for(var E=0;E<C;E++){H=x(this[E]);G=j.cache.elemOldStatus[H][0];if(G=="none"){switch(this[E].tagName.toLowerCase()){case"span":case"a":case"em":case"i":case"b":case"strong":D="inline";break;default:D="block"}}else{if(G=="inline"||G=="inline-block"||G=="flex"||G=="-webkit-flex"||G=="-moz-flex"||G=="-ms-flex"){D=G}else{D="block"}}this[E].style.display=D;if(F&&this[E].style!=="none"){F.call(this[E])}}return this};j.fn.hide=function(E){var C=this.length;if(!C){return this}var F;for(var D=0;D<C;D++){F=x(this[D]);this[D].style.display="none";if(E&&this[D].style==="none"){E.call(this[D])}}return this};return j})(window);"$" in window||(window.$=$$$)}(function(d,b,c){d.os=(function(){var e={};e.webkit=c.match(/WebKit\/([\d.]+)/)?true:false;e.android=c.match(/(Android)\s+([\d.]+)/)||c.match(/Silk-Accelerated/)?true:false;e.androidICS=e.android&&c.match(/(Android)\s4/)?true:false;e.ipad=c.match(/(iPad).*OS\s([\d_]+)/)?true:false;e.iphone=!e.ipad&&c.match(/(iPhone\sOS)\s([\d_]+)/)?true:false;e.ios7=(e.ipad||e.iphone)&&c.match(/7_/)?true:false;e.webos=c.match(/(webOS|hpwOS)[\s\/]([\d.]+)/)?true:false;e.touchpad=e.webos&&c.match(/TouchPad/)?true:false;e.ios=e.ipad||e.iphone;e.playbook=c.match(/PlayBook/)?true:false;e.blackberry10=c.match(/BB10/)?true:false;e.blackberry=e.playbook||e.blackberry10||c.match(/BlackBerry/)?true:false;e.chrome=c.match(/Chrome/)?true:false;e.opera=c.match(/Opera/)?true:false;e.fennec=c.match(/fennec/i)?true:c.match(/Firefox/)?true:false;e.ie=c.match(/MSIE 10.0/i)||c.match(/Trident\/7/i)?true:false;e.ieTouch=e.ie&&c.toLowerCase().match(/touch/i)?true:false;e.tizen=c.match(/Tizen/i)?true:false;e.supportsTouch=((b.DocumentTouch&&document instanceof b.DocumentTouch)||"ontouchstart" in b);e.kindle=c.match(/Silk-Accelerated/)?true:false;if(e.android&&!e.webkit){e.android=false}return e})()})($$$,window,navigator.userAgent);(function($,DOC){var prefix="ms-";var expose=Date.now();var subscribers="$"+expose;var window=this||(0,eval)("this");var otherRequire=window.require;var otherDefine=window.define;var stopRepeatAssign=false;var rword=/[^, ]+/g;var rcomplextype=/^(?:object|array)$/;var rwindow=/^\[object (Window|DOMWindow|global)\]$/;var oproto=Object.prototype;var ohasOwn=oproto.hasOwnProperty;var serialize=oproto.toString;var ap=Array.prototype;var aslice=ap.slice;var Registry={};var head=DOC.head;var root=DOC.documentElement;var hyperspace=DOC.createDocumentFragment();var cinerator=DOC.createElement("div");var class2type={};"Boolean Number String Function Array Date RegExp Object Error".replace(rword,function(name){class2type["[object "+name+"]"]=name.toLowerCase()});function noop(){}function log(a){if(avalon.config.debug){console.log(a)}}window.avalon=function(el){return new avalon.init(el)};avalon.init=function(el){this[0]=this.element=el};avalon.fn=avalon.prototype=avalon.init.prototype;function getType(obj){if(obj==null){return String(obj)}return typeof obj==="object"||typeof obj==="function"?class2type[serialize.call(obj)]||"object":typeof obj}avalon.type=getType;avalon.isWindow=function(obj){return rwindow.test(serialize.call(obj))};avalon.isPlainObject=function(obj){return !!obj&&typeof obj==="object"&&Object.getPrototypeOf(obj)===oproto};avalon.mix=avalon.fn.mix=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i++}if(typeof target!=="object"&&getType(target)!=="function"){target={}}if(i===length){target=this;i--}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(avalon.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&Array.isArray(src)?src:[]}else{clone=src&&avalon.isPlainObject(src)?src:{}}target[name]=avalon.mix(deep,clone,copy)}else{if(copy!==void 0){target[name]=copy}}}}}return target};function resetNumber(a,n,end){if((a===+a)&&!(a%1)){if(a<0){a=a*-1>=n?0:a+n}else{a=a>n?n:a}}else{a=end?n:0}return a}function oneObject(array,val){if(typeof array==="string"){array=array.match(rword)||[]}var result={},value=val!==void 0?val:1;for(var i=0,n=array.length;i<n;i++){result[array[i]]=value}return result}avalon.mix({rword:rword,subscribers:subscribers,version:1.31,ui:{},models:{},log:log,noop:noop,error:function(str,e){throw new (e||Error)(str)},oneObject:oneObject,range:function(start,end,step){step||(step=1);if(end==null){end=start||0;start=0}var index=-1,length=Math.max(0,Math.ceil((end-start)/step)),result=Array(length);while(++index<length){result[index]=start;start+=step}return result},slice:function(nodes,start,end){return aslice.call(nodes,start,end)},contains:function(a,b){return a.contains(b)},eventHooks:{},bind:function(el,type,fn,phase){var hooks=avalon.eventHooks;var hook=hooks[type];if(typeof hook==="object"){type=hook.type;if(hook.deel){fn=hook.deel(el,fn)}}el.addEventListener(type,fn,!!phase);return fn},unbind:function(el,type,fn,phase){var hooks=avalon.eventHooks;var hook=hooks[type];if(typeof hook==="object"){type=hook.type}el.removeEventListener(type,fn||noop,!!phase)},fire:function(el,name){var event=DOC.createEvent("Events");event.initEvent(name,true,true);el.dispatchEvent(event)},css:function(node,name,value){if(node instanceof avalon){node=node[0]}var prop=/[_-]/.test(name)?camelize(name):name;name=avalon.cssName(prop)||prop;if(value===void 0||typeof value==="boolean"){var fn=cssHooks[prop+":get"]||cssHooks["@:get"];var val=fn(node,name);return value===true?parseFloat(val)||0:val}else{if(value===""){node.style[name]=""}else{if(value==null||value!==value){return}if(isFinite(value)&&!avalon.cssNumber[prop]){value+="px"}fn=cssHooks[prop+":set"]||cssHooks["@:set"];fn(node,name,value)}}},each:function(obj,fn){if(obj){var i=0;if(isArrayLike(obj)){for(var n=obj.length;i<n;i++){fn(i,obj[i])}}else{for(i in obj){if(obj.hasOwnProperty(i)){fn(i,obj[i])}}}}},getWidgetData:function(elem,prefix){var raw=avalon(elem).data();var result={};for(var i in raw){if(i.indexOf(prefix)===0){result[i.replace(prefix,"").replace(/\w/,function(a){return a.toLowerCase()})]=raw[i]}}return result},parseJSON:JSON.parse,Array:{ensure:function(target,item){if(target.indexOf(item)===-1){target.push(item)}return target},removeAt:function(target,index){return !!target.splice(index,1).length},remove:function(target,item){var index=target.indexOf(item);if(~index){return avalon.Array.removeAt(target,index)}return false}}});function generateID(){return"avalon"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function isArrayLike(obj){if(obj&&typeof obj==="object"){var n=obj.length,str=serialize.call(obj);if(/(Array|List|Collection|Map|Arguments)\]$/.test(str)){return true}else{if(str==="[object Object]"&&(+n===n&&!(n%1)&&n>=0)){return true}}}return false}avalon.isArrayLike=isArrayLike;avalon.nextTick=window.setImmediate?setImmediate.bind(window):function(callback){setTimeout(callback,0)};if(!root.contains){Node.prototype.contains=function(arg){return !!(this.compareDocumentPosition(arg)&16)}}var VMODELS=avalon.vmodels={};avalon.define=function(id,factory){if(VMODELS[id]){log("warning: "+id+" 已经存在于avalon.vmodels中")}var scope={$watch:noop};factory(scope);var model=modelFactory(scope);stopRepeatAssign=true;factory(model);stopRepeatAssign=false;model.$id=id;return VMODELS[id]=model};function modelFactory(scope,model){if(Array.isArray(scope)){var arr=scope.concat();scope.length=0;var collection=Collection(scope);collection.push.apply(collection,arr);return collection}if(typeof scope.nodeType==="number"){return scope}var vmodel={};model=model||{};var accessingProperties={};var normalProperties={};var computedProperties=[];var watchProperties=arguments[2]||{};var skipArray=scope.$skipArray;for(var i=0,name;name=skipProperties[i++];){delete scope[name];normalProperties[name]=true}if(Array.isArray(skipArray)){for(var i=0,name;name=skipArray[i++];){normalProperties[name]=true}}for(var i in scope){loopModel(i,scope[i],model,normalProperties,accessingProperties,computedProperties,watchProperties)}vmodel=Object.defineProperties(vmodel,descriptorFactory(accessingProperties));for(var name in normalProperties){vmodel[name]=normalProperties[name]}watchProperties.vmodel=vmodel;vmodel.$model=model;vmodel.$events={};vmodel.$id=generateID();vmodel.$accessors=accessingProperties;vmodel[subscribers]=[];for(var i in Observable){vmodel[i]=Observable[i]}Object.defineProperty(vmodel,"hasOwnProperty",{value:function(name){return name in vmodel.$model},writable:false,enumerable:false,configurable:true});for(var i=0,fn;fn=computedProperties[i++];){Registry[expose]=fn;fn();collectSubscribers(fn);delete Registry[expose]}return vmodel}var skipProperties=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$accessors,"+subscribers).match(rword);var isEqual=Object.is||function(v1,v2){if(v1===0&&v2===0){return 1/v1===1/v2}else{if(v1!==v1){return v2!==v2}else{return v1===v2}}};function safeFire(a,b,c,d){if(a.$events){Observable.$fire.call(a,b,c,d)}}function descriptorFactory(obj){var descriptors={};for(var i in obj){descriptors[i]={get:obj[i],set:obj[i],enumerable:true,configurable:true}}return descriptors}function loopModel(name,val,model,normalProperties,accessingProperties,computedProperties,watchProperties){model[name]=val;if(normalProperties[name]||(val&&val.nodeType)){return normalProperties[name]=val}if(name[0]==="$"&&!watchProperties[name]){return normalProperties[name]=val}var valueType=getType(val);if(valueType==="function"){return normalProperties[name]=val}var accessor,oldArgs;if(valueType==="object"&&typeof val.get==="function"&&Object.keys(val).length<=2){var setter=val.set,getter=val.get;accessor=function(newValue){var vmodel=watchProperties.vmodel;var value=model[name],preValue=value;if(arguments.length){if(stopRepeatAssign){return}if(typeof setter==="function"){var backup=vmodel.$events[name];vmodel.$events[name]=[];setter.call(vmodel,newValue);vmodel.$events[name]=backup}if(!isEqual(oldArgs,newValue)){oldArgs=newValue;newValue=model[name]=getter.call(vmodel);withProxyCount&&updateWithProxy(vmodel.$id,name,newValue);notifySubscribers(accessor);safeFire(vmodel,name,newValue,preValue)}}else{if(avalon.openComputedCollect){collectSubscribers(accessor)}newValue=model[name]=getter.call(vmodel);if(!isEqual(value,newValue)){oldArgs=void 0;safeFire(vmodel,name,newValue,preValue)}return newValue}};computedProperties.push(accessor)}else{if(rcomplextype.test(valueType)){accessor=function(newValue){var realAccessor=accessor.$vmodel,preValue=realAccessor.$model;if(arguments.length){if(stopRepeatAssign){return}if(!isEqual(preValue,newValue)){newValue=accessor.$vmodel=updateVModel(realAccessor,newValue,valueType);var fn=rebindings[newValue.$id];fn&&fn();var parent=watchProperties.vmodel;model[name]=newValue.$model;notifySubscribers(realAccessor);safeFire(parent,name,model[name],preValue)}}else{collectSubscribers(realAccessor);return realAccessor}};accessor.$vmodel=val.$model?val:modelFactory(val,val);model[name]=accessor.$vmodel.$model}else{accessor=function(newValue){var preValue=model[name];if(arguments.length){if(!isEqual(preValue,newValue)){model[name]=newValue;var vmodel=watchProperties.vmodel;withProxyCount&&updateWithProxy(vmodel.$id,name,newValue);notifySubscribers(accessor);safeFire(vmodel,name,newValue,preValue)}}else{collectSubscribers(accessor);return preValue}};model[name]=val}}accessor[subscribers]=[];accessingProperties[name]=accessor}var withProxyPool={};var withProxyCount=0;var rebindings={};function updateWithProxy($id,name,val){var pool=withProxyPool[$id];if(pool&&pool[name]){pool[name].$val=val}}function updateVModel(a,b,valueType){if(valueType==="array"){if(!Array.isArray(b)){return a}var bb=b.concat();a.clear();a.push.apply(a,bb);return a}else{var iterators=a[subscribers]||[];if(withProxyPool[a.$id]){withProxyCount--;delete withProxyPool[a.$id]}var ret=modelFactory(b);rebindings[ret.$id]=function(data){while(data=iterators.shift()){(function(el){if(el.type){avalon.nextTick(function(){el.rollback&&el.rollback();bindingHandlers[el.type](el,el.vmodels)})}})(data)}delete rebindings[ret.$id]};return ret}}function kernel(settings){for(var p in settings){if(!ohasOwn.call(settings,p)){continue}var val=settings[p];if(typeof kernel.plugins[p]==="function"){kernel.plugins[p](val)}else{if(typeof kernel[p]==="object"){avalon.mix(kernel[p],val)}else{kernel[p]=val}}}return this}var openTag,closeTag,rexpr,rexprg,rbind,rregexp=/[-.*+?^${}()|[\]\/\\]/g;function escapeRegExp(target){return(target+"").replace(rregexp,"\\$&")}var plugins={loader:function(builtin){window.define=builtin?innerRequire.define:otherDefine;window.require=builtin?innerRequire:otherRequire},interpolate:function(array){openTag=array[0];closeTag=array[1];if(openTag===closeTag){avalon.error("openTag!==closeTag",SyntaxError)}else{if(array+""==="<!--,-->"){kernel.commentInterpolate=true}else{var test=openTag+"test"+closeTag;cinerator.innerHTML=test;if(cinerator.innerHTML!==test&&cinerator.innerHTML.indexOf("&lt;")>=0){avalon.error("此定界符不合法",SyntaxError)}cinerator.innerHTML=""}}var o=escapeRegExp(openTag),c=escapeRegExp(closeTag);rexpr=new RegExp(o+"(.*?)"+c);rexprg=new RegExp(o+"(.*?)"+c,"g");rbind=new RegExp(o+".*?"+c+"|\\sms-")}};kernel.debug=false;kernel.plugins=plugins;kernel.plugins.interpolate(["{{","}}"]);kernel.paths={};kernel.shim={};kernel.maxRepeatSize=100;avalon.config=kernel;if(window.SVGElement&&!("innerHTML" in document.createElementNS("'http://www.w3.org/2000/svg","svg"))){Object.defineProperty(SVGElement.prototype,"outerHTML",{get:function(){return new XMLSerializer().serializeToString(this)}});Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var s=this.outerHTML;var ropen=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i");var rclose=new RegExp("</"+this.nodeName+">$","i");return s.replace(ropen,"").replace(rclose,"")}})}function hyphen(target){return target.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function camelize(target){if(target.indexOf("-")<0&&target.indexOf("_")<0){return target}return target.replace(/[-_][^-_]/g,function(match){return match.charAt(1).toUpperCase()})}var rnospaces=/\S+/g;avalon.fn.mix({hasClass:function(cls){var el=this[0]||{};return el.nodeType===1&&el.classList.contains(cls)},toggleClass:function(value,stateVal){var state=stateVal,className,i=0;var classNames=value.match(rnospaces)||[];var isBool=typeof stateVal==="boolean";var node=this[0]||{},classList;if(classList=node.classList){while((className=classNames[i++])){state=isBool?state:!classList.contains(className);classList[state?"add":"remove"](className)}}return this},attr:function(name,value){if(arguments.length===2){this[0].setAttribute(name,value);return this}else{return this[0].getAttribute(name)}},data:function(name,value){name="data-"+hyphen(name||"");switch(arguments.length){case 2:this.attr(name,value);return this;case 1:var val=this.attr(name);return parseData(val);case 0:var ret={};ap.forEach.call(this[0].attributes,function(attr){if(attr){name=attr.name;if(!name.indexOf("data-")){name=camelize(name.slice(5));ret[name]=parseData(attr.value)}}});return ret}},removeData:function(name){name="data-"+hyphen(name);this[0].removeAttribute(name);return this},css:function(name,value){if(avalon.isPlainObject(name)){for(var i in name){avalon.css(this,i,name[i])}}else{var ret=avalon.css(this,name,value)}return ret!==void 0?ret:this},position:function(){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if(!elem){return}if(this.css("position")==="fixed"){offset=elem.getBoundingClientRect()}else{offsetParent=this.offsetParent();offset=this.offset();if(offsetParent[0].tagName!=="HTML"){parentOffset=offsetParent.offset()}parentOffset.top+=avalon.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=avalon.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-avalon.css(elem,"marginTop",true),left:offset.left-parentOffset.left-avalon.css(elem,"marginLeft",true)}},offsetParent:function(){var offsetParent=this[0].offsetParent||root;while(offsetParent&&(offsetParent.tagName!=="HTML")&&avalon.css(offsetParent,"position")==="static"){offsetParent=offsetParent.offsetParent}return avalon(offsetParent||root)},bind:function(type,fn,phase){if(this[0]){return avalon.bind(this[0],type,fn,phase)}},unbind:function(type,fn,phase){if(this[0]){avalon.unbind(this[0],type,fn,phase)}return this},val:function(value){var node=this[0];if(node&&node.nodeType===1){var get=arguments.length===0;var access=get?":get":":set";var fn=valHooks[getValType(node)+access];if(fn){var val=fn(node,value)}else{if(get){return(node.value||"").replace(/\r/g,"")}else{node.value=value}}}return get?val:this}});"add,remove".replace(rword,function(method){avalon.fn[method+"Class"]=function(cls){var el=this[0];if(cls&&typeof cls==="string"&&el&&el.nodeType==1){cls.replace(rnospaces,function(c){el.classList[method](c)})}return this}});if(root.dataset){avalon.data=function(name,val){var dataset=this[0].dataset;switch(arguments.length){case 2:dataset[name]=val;return this;case 1:val=dataset[name];return parseData(val);case 0:var ret={};for(var name in dataset){ret[name]=parseData(dataset[name])}return ret}}}var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;function parseData(data){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?JSON.parse(data):data}catch(e){}return data}avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){avalon.fn[method]=function(val){var node=this[0]||{},win=getWindow(node),top=method==="scrollTop";if(!arguments.length){return win?win[prop]:node[method]}else{if(win){win.scrollTo(!top?val:avalon(win).scrollLeft(),top?val:avalon(win).scrollTop())}else{node[method]=val}}}});function getWindow(node){return node.window&&node.document?node:node.nodeType===9?node.defaultView:false}var cssHooks=avalon.cssHooks={};var prefixes=["","-webkit-","-o-","-moz-","-ms-"];var cssMap={"float":"cssFloat",background:"backgroundColor"};avalon.cssNumber=oneObject("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom");avalon.cssName=function(name,host,camelCase){if(cssMap[name]){return cssMap[name]}host=host||root.style;for(var i=0,n=prefixes.length;i<n;i++){camelCase=camelize(prefixes[i]+name);if(camelCase in host){return(cssMap[name]=camelCase)}}return null};cssHooks["@:set"]=function(node,name,value){node.style[name]=value};cssHooks["@:get"]=function(node,name){if(!node||!node.style){throw new Error("getComputedStyle要求传入一个节点 "+node)}var ret,styles=getComputedStyle(node,null);if(styles){ret=styles.getPropertyValue(name);if(ret===""){ret=node.style[name]}}return ret};cssHooks["opacity:get"]=function(node){var ret=cssHooks["@:get"](node,"opacity");return ret===""?"1":ret};"top,left".replace(rword,function(name){cssHooks[name+":get"]=function(node){var computed=cssHooks["@:get"](node,name);return/px$/.test(computed)?computed:avalon(node).position()[name]+"px"}});var cssShow={position:"absolute",visibility:"hidden",display:"block"};var rdisplayswap=/^(none|table(?!-c[ea]).+)/;function showHidden(node,array){if(node.offsetWidth<=0){var styles=getComputedStyle(node,null);if(rdisplayswap.test(styles.display)){var obj={node:node};for(var name in cssShow){obj[name]=styles[name];node.style[name]=cssShow[name]}array.push(obj)}var parent=node.parentNode;if(parent&&parent.nodeType==1){showHidden(parent,array)}}}"Width,Height".replace(rword,function(name){var method=name.toLowerCase(),clientProp="client"+name,scrollProp="scroll"+name,offsetProp="offset"+name;cssHooks[method+":get"]=function(node,which,override){var boxSizing="content-box";if(typeof override==="string"){boxSizing=override}which=name==="Width"?["Left","Right"]:["Top","Bottom"];switch(boxSizing){case"content-box":return node["client"+name]-avalon.css(node,"padding"+which[0],true)-avalon.css(node,"padding"+which[1],true);case"padding-box":return node["client"+name];case"border-box":return node["offset"+name];case"margin-box":return node["offset"+name]+avalon.css(node,"margin"+which[0],true)+avalon.css(node,"margin"+which[1],true)}};cssHooks[method+"&get"]=function(node){var hidden=[];showHidden(node,hidden);var val=cssHooks[method+":get"](node);for(var i=0,obj;obj=hidden[i++];){node=obj.node;for(var n in obj){if(typeof obj[n]==="string"){node.style[n]=obj[n]}}}return val};avalon.fn[method]=function(value){var node=this[0];if(arguments.length===0){if(node.setTimeout){return node["inner"+name]}if(node.nodeType===9){var doc=node.documentElement;return Math.max(node.body[scrollProp],doc[scrollProp],node.body[offsetProp],doc[offsetProp],doc[clientProp])}return cssHooks[method+"&get"](node)}else{return this.css(method,value)}};avalon.fn["inner"+name]=function(){return cssHooks[method+":get"](this[0],void 0,"padding-box")};avalon.fn["outer"+name]=function(includeMargin){return cssHooks[method+":get"](this[0],void 0,includeMargin===true?"margin-box":"border-box")}});avalon.fn.offset=function(){var node=this[0],box={left:0,top:0};if(!node||!node.tagName||!node.ownerDocument){return box}var doc=node.ownerDocument,root=doc.documentElement,win=doc.defaultView;if(!root.contains(node)){return box}if(node.getBoundingClientRect!==void 0){box=node.getBoundingClientRect()}return{top:box.top+win.pageYOffset-root.clientTop,left:box.left+win.pageXOffset-root.clientLeft}};function getValType(el){var ret=el.tagName.toLowerCase();return ret==="input"&&/checkbox|radio/.test(el.type)?"checked":ret}var valHooks={"select:get":function(node,value){var option,options=node.options,index=node.selectedIndex,one=node.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&!option.disabled){value=option.value;if(one){return value}values.push(value)}}return values},"select:set":function(node,values,optionSet){values=[].concat(values);for(var i=0,el;el=node.options[i++];){if((el.selected=values.indexOf(el.value)>=0)){optionSet=true}}if(!optionSet){node.selectedIndex=-1}}};var rtagName=/<([\w:]+)/,rxhtml=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,scriptTypes=oneObject("text/javascript","text/ecmascript","application/ecmascript","application/javascript","text/vbscript"),rnest=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/;var tagHooks=new function(){avalon.mix(this,{option:DOC.createElement("select"),thead:DOC.createElement("table"),td:DOC.createElement("tr"),area:DOC.createElement("map"),tr:DOC.createElement("tbody"),col:DOC.createElement("colgroup"),legend:DOC.createElement("fieldset"),"*":DOC.createElement("div")});this.optgroup=this.option;this.tbody=this.tfoot=this.colgroup=this.caption=this.thead;this.th=this.td};avalon.clearHTML=function(node){node.textContent="";return node};var script=DOC.createElement("script");avalon.parseHTML=function(html){if(typeof html!=="string"){html=html+""}html=html.replace(rxhtml,"<$1></$2>").trim();if(deleteRange.createContextualFragment&&!rnest.test(html)&&!/<script/i.test(html)){var range=DOC.createRange();range.selectNodeContents(root);return range.createContextualFragment(html)}var fragment=hyperspace.cloneNode(false);var tag=(rtagName.exec(html)||["",""])[1].toLowerCase();if(!(tag in tagHooks)){tag="*"}var parent=tagHooks[tag];parent.innerHTML=html;var els=parent.getElementsByTagName("script"),firstChild,neo;if(els.length){for(var i=0,el;el=els[i++];){if(!el.type||scriptTypes[el.type]){neo=script.cloneNode(false);ap.forEach.call(el.attributes,function(attr){if(attr){neo[attr.name]=attr.value}});neo.text=el.text;el.parentNode.replaceChild(neo,el)}}}while(firstChild=parent.firstChild){fragment.appendChild(firstChild)}return fragment};avalon.innerHTML=function(node,html){if(!/<script/i.test(html)&&!rnest.test(html)){node.innerHTML=html}else{var a=this.parseHTML(html);this.clearHTML(node).appendChild(a)}};var Observable={$watch:function(type,callback){if(typeof callback==="function"){var callbacks=this.$events[type];if(callbacks){callbacks.push(callback)}else{this.$events[type]=[callback]}}else{this.$events=this.$watch.backup}return this},$unwatch:function(type,callback){var n=arguments.length;if(n===0){this.$watch.backup=this.$events;this.$events={}}else{if(n===1){this.$events[type]=[]}else{var callbacks=this.$events[type]||[];var i=callbacks.length;while(~--i<0){if(callbacks[i]===callback){return callbacks.splice(i,1)}}}}return this},$fire:function(type){var callbacks=this.$events[type]||[];var all=this.$events.$all||[];var args=aslice.call(arguments,1);for(var i=0,callback;callback=callbacks[i++];){callback.apply(this,args)}for(var i=0,callback;callback=all[i++];){callback.apply(this,arguments)}}};function registerSubscriber(data,val){Registry[expose]=data;avalon.openComputedCollect=true;var fn=data.evaluator;if(fn){if(data.type==="duplex"){data.handler()}else{try{data.handler(fn.apply(0,data.args),data.element,data)}catch(e){delete data.evaluator;if(data.nodeType===3){if(kernel.commentInterpolate){data.element.replaceChild(DOC.createComment(data.value),data.node)}else{data.node.data=openTag+data.value+closeTag}}log("warning:evaluator of ["+data.value+"] throws error!")}}}else{data()}avalon.openComputedCollect=false;delete Registry[expose]}function collectSubscribers(accessor){if(Registry[expose]){var list=accessor[subscribers];list&&avalon.Array.ensure(list,Registry[expose])}}function notifySubscribers(accessor){var list=accessor[subscribers];if(list&&list.length){var args=aslice.call(arguments,1);for(var i=list.length,fn;fn=list[--i];){var el=fn.element;if(el&&!ifSanctuary.contains(el)&&(!root.contains(el))){list.splice(i,1);log("debug: remove "+fn.name)}else{if(typeof fn==="function"){fn.apply(0,args)}else{if(fn.getter){fn.handler.apply(fn,args)}else{fn.handler(fn.evaluator.apply(0,fn.args||[]),el,fn)}}}}}}avalon.scan=function(elem,vmodel){elem=elem||root;var vmodels=vmodel?[].concat(vmodel):[];scanTag(elem,vmodels)};var stopScan=oneObject("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,noscript,script,style,textarea".toUpperCase());function checkScan(elem,callback){var innerHTML=NaN,id=setInterval(function(){var currHTML=elem.innerHTML;if(currHTML===innerHTML){clearInterval(id);callback()}else{innerHTML=currHTML}},15)}function scanTag(elem,vmodels,node){var a=elem.getAttribute(prefix+"skip");var b=elem.getAttributeNode(prefix+"important");var c=elem.getAttributeNode(prefix+"controller");if(typeof a==="string"){return}else{if(node=b||c){var newVmodel=VMODELS[node.value];if(!newVmodel){return}vmodels=node===b?[newVmodel]:[newVmodel].concat(vmodels);elem.removeAttribute(node.name);elem.classList.remove(node.name)}}scanAttr(elem,vmodels)}function scanNodes(parent,vmodels){var node=parent.firstChild;while(node){var nextNode=node.nextSibling;var nodeType=node.nodeType;if(nodeType===1){scanTag(node,vmodels)}else{if(nodeType===3&&rexpr.test(node.data)){scanText(node,vmodels)}else{if(kernel.commentInterpolate&&nodeType===8&&!rexpr.test(node.nodeValue)){scanText(node,vmodels)}}}node=nextNode}}function scanText(textNode,vmodels){var bindings=[];if(textNode.nodeType===8){var leach=[];var value=trimFilter(textNode.nodeValue,leach);var token={expr:true,value:value};if(leach.length){token.filters=leach}var tokens=[token]}else{tokens=scanExpr(textNode.data)}if(tokens.length){for(var i=0,token;token=tokens[i++];){var node=DOC.createTextNode(token.value);if(token.expr){var filters=token.filters;var binding={type:"text",node:node,nodeType:3,value:token.value,filters:filters};if(filters&&filters.indexOf("html")!==-1){avalon.Array.remove(filters,"html");binding.type="html";binding.replaceNodes=[node];if(!filters.length){delete bindings.filters}}bindings.push(binding)}hyperspace.appendChild(node)}textNode.parentNode.replaceChild(hyperspace,textNode);if(bindings.length){executeBindings(bindings,vmodels)}}}var rmsAttr=/ms-(\w+)-?(.*)/;var priorityMap={"if":10,repeat:90,widget:110,each:1400,"with":1500,duplex:2000,on:3000};var ons=oneObject("dblclick,mouseout,click,input,mouseover,mouseenter,mouseleave,mousemove,mousedown,mouseup,keypress,keydown,keyup,blur,focus,change,animationend");function scanAttr(elem,vmodels){var attributes=elem.attributes;var bindings=[],msData={},match;for(var i=0,attr;attr=attributes[i++];){if(attr.specified){if(match=attr.name.match(rmsAttr)){var type=match[1];var param=match[2]||"";msData[attr.name]=attr.value;if(ons[type]){param=type;type="on"}if(typeof bindingHandlers[type]==="function"){var binding={type:type,param:param,element:elem,name:match[0],value:attr.value,priority:type in priorityMap?priorityMap[type]:type.charCodeAt(0)*10+(Number(param)||0)};if(type==="if"&&param==="loop"){binding.priority+=100}if(vmodels.length){bindings.push(binding);if(type==="widget"){elem.msData=elem.msData||msData}}}}}}if(msData["ms-checked"]&&msData["ms-duplex"]){log("warning!一个元素上不能同时定义ms-checked与ms-duplex")}bindings.sort(function(a,b){return a.priority-b.priority});var firstBinding=bindings[0]||{};switch(firstBinding.type){case"if":case"repeat":case"widget":executeBindings([firstBinding],vmodels);break;default:executeBindings(bindings,vmodels);if(!stopScan[elem.tagName]&&rbind.test(elem.innerHTML+elem.textContent)){scanNodes(elem,vmodels)}break}if(elem.patchRepeat){elem.patchRepeat();elem.patchRepeat=null}}function executeBindings(bindings,vmodels){for(var i=0,data;data=bindings[i++];){data.vmodels=vmodels;bindingHandlers[data.type](data,vmodels);if(data.evaluator&&data.name){data.element.removeAttribute(data.name)}}bindings.length=0}var rfilters=/\|\s*(\w+)\s*(\([^)]*\))?/g,r11a=/\|\|/g,r11b=/U2hvcnRDaXJjdWl0/g,rlt=/&lt;/g,rgt=/&gt;/g;function trimFilter(value,leach){if(value.indexOf("|")>0){value=value.replace(r11a,"U2hvcnRDaXJjdWl0");value=value.replace(rfilters,function(c,d,e){leach.push(d+(e||""));return""});value=value.replace(r11b,"||")}return value}function scanExpr(str){var tokens=[],value,start=0,stop;do{stop=str.indexOf(openTag,start);if(stop===-1){break}value=str.slice(start,stop);if(value){tokens.push({value:value,expr:false})}start=stop+openTag.length;stop=str.indexOf(closeTag,start);if(stop===-1){break}value=str.slice(start,stop);if(value){var leach=[];value=trimFilter(value,leach);tokens.push({value:value,expr:true,filters:leach.length?leach:void 0})}start=stop+closeTag.length}while(1);value=str.slice(start);if(value){tokens.push({value:value,expr:false})}return tokens}var keywords="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined";var rrexpstr=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g;var rsplit=/[^\w$]+/g;var rkeywords=new RegExp(["\\b"+keywords.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g");var rnumber=/\b\d[^,]*/g;var rcomma=/^,+|,+$/g;var cacheVars=createCache(512);var getVariables=function(code){code=","+code.trim();if(cacheVars[code]){return cacheVars[code]}var match=code.replace(rrexpstr,"").replace(rsplit,",").replace(rkeywords,"").replace(rnumber,"").replace(rcomma,"").split(/^$|,+/);var vars=[],unique={};for(var i=0;i<match.length;++i){var variable=match[i];if(!unique[variable]){unique[variable]=vars.push(variable)}}return cacheVars(code,vars)};function addAssign(vars,scope,name,duplex){var ret=[],prefix=" = "+name+".";for(var i=vars.length,prop;prop=vars[--i];){if(scope.hasOwnProperty(prop)){ret.push(prop+prefix+prop);if(duplex==="duplex"){vars.get=name+"."+prop}vars.splice(i,1)}}return ret}function uniqVmodels(arr){var uniq={};return arr.filter(function(el){if(!uniq[el.$id]){uniq[el.$id]=1;return true}})}function createCache(maxLength){var keys=[];function cache(key,value){if(keys.push(key)>maxLength){delete cache[keys.shift()]}return cache[key]=value}return cache}var cacheExprs=createCache(256);var rduplex=/\w\[.*\]|\w\.\w/;var rproxy=/(\$proxy\$[a-z]+)\d+$/;function parseExpr(code,scopes,data,four){var dataType=data.type;var filters=dataType==="html"||dataType==="text"?data.filters:"";var exprId=scopes.map(function(el){return el.$id.replace(rproxy,"$1")})+code+dataType+filters;var vars=getVariables(code).concat(),assigns=[],names=[],args=[],prefix="";scopes=uniqVmodels(scopes);for(var i=0,sn=scopes.length;i<sn;i++){if(vars.length){var name="vm"+expose+"_"+i;names.push(name);args.push(scopes[i]);assigns.push.apply(assigns,addAssign(vars,scopes[i],name,four))}}if(!assigns.length&&four==="duplex"){return}if(filters){args.push(avalon.filters)}data.args=args;var fn=cacheExprs[exprId];if(fn){data.evaluator=fn;return}var prefix=assigns.join(", ");if(prefix){prefix="var "+prefix}if(filters){code="\nvar ret"+expose+" = "+code;var textBuffer=[],fargs;textBuffer.push(code,"\r\n");for(var i=0,fname;fname=data.filters[i++];){var start=fname.indexOf("(");if(start!==-1){fargs=fname.slice(start+1,fname.lastIndexOf(")")).trim();fargs=","+fargs;fname=fname.slice(0,start).trim()}else{fargs=""}textBuffer.push(" if(filters",expose,".",fname,"){\n\ttry{\nret",expose," = filters",expose,".",fname,"(ret",expose,fargs,")\n\t}catch(e){} \n}\n")}code=textBuffer.join("");code+="\nreturn ret"+expose;names.push("filters"+expose)}else{if(dataType==="duplex"){var _body="'use strict';\nreturn function(vvv){\n\t"+prefix+";\n\tif(!arguments.length){\n\t\treturn "+code+"\n\t}\n\t"+(!rduplex.test(code)?vars.get:code)+"= vvv;\n} ";try{fn=Function.apply(noop,names.concat(_body));data.evaluator=cacheExprs(exprId,fn)}catch(e){log("debug: parse error,"+e.message)}return}else{if(dataType==="on"){code=code.replace("(",".call(this,");if(four==="$event"){names.push(four)}code="\nreturn "+code+";";var lastIndex=code.lastIndexOf("\nreturn");var header=code.slice(0,lastIndex);var footer=code.slice(lastIndex);code=header+"\nif(avalon.openComputedCollect) return ;"+footer}else{code="\nreturn "+code+";"}}}try{fn=Function.apply(noop,names.concat("'use strict';\n"+prefix+code));data.evaluator=cacheExprs(exprId,fn)}catch(e){log("debug: parse error,"+e.message)}finally{vars=textBuffer=names=null}}function parseExprProxy(code,scopes,data,tokens){if(Array.isArray(tokens)){var array=tokens.map(function(token){var tmpl={};return token.expr?parseExpr(token.value,scopes,tmpl)||tmpl:token.value});data.evaluator=function(){var ret="";for(var i=0,el;el=array[i++];){ret+=typeof el==="string"?el:el.evaluator.apply(0,el.args)}return ret};data.args=[]}else{parseExpr(code,scopes,data,tokens)}if(data.evaluator){data.handler=bindingExecutors[data.handlerName||data.type];data.evaluator.toString=function(){return data.type+" binding to eval("+code+")"};registerSubscriber(data)}}avalon.parseExprProxy=parseExprProxy;var cacheDisplay=oneObject("a,abbr,b,span,strong,em,font,i,kbd","inline");avalon.mix(cacheDisplay,oneObject("div,h1,h2,h3,h4,h5,h6,section,p","block"));function parseDisplay(nodeName,val){nodeName=nodeName.toLowerCase();if(!cacheDisplay[nodeName]){var node=DOC.createElement(nodeName);root.appendChild(node);val=getComputedStyle(node,null).display;root.removeChild(node);cacheDisplay[nodeName]=val}return cacheDisplay[nodeName]}avalon.parseDisplay=parseDisplay;var supportDisplay=(function(td){return getComputedStyle(td,null).display=="table-cell"})(DOC.createElement("td"));var rdash=/\(([^)]*)\)/;var getBindingCallback=function(elem,name,vmodels){var callback=elem.getAttribute(name);if(callback){for(var i=0,vm;vm=vmodels[i++];){if(vm.hasOwnProperty(callback)&&typeof vm[callback]==="function"){return vm[callback]}}}};var cacheTmpls=avalon.templateCache={};var ifSanctuary=DOC.createElement("div");var rwhitespace=/^\s+$/;var bindingExecutors=avalon.bindingExecutors={attr:function(val,elem,data){var method=data.type,attrName=data.param;function scanTemplate(text){if(loaded){text=loaded.apply(elem,[text].concat(vmodels))}avalon.innerHTML(elem,text);scanNodes(elem,vmodels);rendered&&checkScan(elem,function(){rendered.call(elem)})}if(method==="css"){avalon(elem).css(attrName,val)}else{if(method==="attr"){var toRemove=(val===false)||(val===null)||(val===void 0);if(toRemove){elem.removeAttribute(attrName)}else{elem.setAttribute(attrName,val)}}else{if(method==="include"&&val){var vmodels=data.vmodels;var rendered=getBindingCallback(elem,"data-include-rendered",vmodels);var loaded=getBindingCallback(elem,"data-include-loaded",vmodels);if(data.param==="src"){if(cacheTmpls[val]){scanTemplate(cacheTmpls[val])}else{var xhr=new window.XMLHttpRequest;xhr.onload=function(){var s=xhr.status;if(s>=200&&s<300||s===304){scanTemplate(cacheTmpls[val]=xhr.responseText)}};xhr.open("GET",val,true);xhr.withCredentials=true;xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.send(null)}}else{var el=val&&val.nodeType==1?val:DOC.getElementById(val);avalon.nextTick(function(){scanTemplate(el.innerText||el.innerHTML)})}}else{elem[method]=val}}}},"class":function(val,elem,data){var $elem=avalon(elem),method=data.type;if(method==="class"&&data.param){$elem.toggleClass(data.param,!!val)}else{var toggle=data._evaluator?!!data._evaluator.apply(elem,data._args):true;var className=data._class||val;switch(method){case"class":if(toggle&&data.oldClass){$elem.removeClass(data.oldClass)}$elem.toggleClass(className,toggle);data.oldClass=className;break;case"hover":case"active":if(!data.init){if(method==="hover"){var event1="mouseenter",event2="mouseleave"}else{elem.tabIndex=elem.tabIndex||-1;event1="mousedown",event2="mouseup";$elem.bind("mouseleave",function(){toggle&&$elem.removeClass(className)})}$elem.bind(event1,function(){toggle&&$elem.addClass(className)});$elem.bind(event2,function(){toggle&&$elem.removeClass(className)});data.init=1}break}}},data:function(val,elem,data){var key="data-"+data.param;if(val&&typeof val==="object"){elem[key]=val}else{elem.setAttribute(key,String(val))}},checked:function(val,elem,data){var name=data.type;if(name==="enabled"){elem.disabled=!val}else{var propName=name==="readonly"?"readOnly":name;elem[propName]=!!val}},repeat:function(method,pos,el){if(method){var data=this;var group=data.group;var pp=data.startRepeat&&data.startRepeat.parentNode;if(pp){data.parent=pp}var parent=data.parent;var proxies=data.proxies;var transation=hyperspace.cloneNode(false);var spans=[];var lastFn={};if(method==="del"||method==="move"){var locatedNode=getLocatedNode(parent,data,pos)}switch(method){case"add":var arr=el;var last=data.getter().length-1;for(var i=0,n=arr.length;i<n;i++){var ii=i+pos;var proxy=getEachProxy(ii,arr[i],data,last);proxies.splice(ii,0,proxy);lastFn=shimController(data,transation,spans,proxy)}locatedNode=getLocatedNode(parent,data,pos);lastFn.node=locatedNode;lastFn.parent=parent;parent.insertBefore(transation,locatedNode);for(var i=0,node;node=spans[i++];){scanTag(node,data.vmodels)}spans=null;break;case"del":var removed=proxies.splice(pos,el);for(var i=0,proxy;proxy=removed[i++];){recycleEachProxy(proxy)}expelFromSanctuary(removeView(locatedNode,group,el));break;case"index":var last=proxies.length-1;for(;el=proxies[pos];pos++){el.$index=pos;el.$first=pos===0;el.$last=pos===last}break;case"clear":if(data.startRepeat){while(true){var node=data.startRepeat.nextSibling;if(node&&node!==data.endRepeat){transation.appendChild(node)}else{break}}}else{transation=parent}expelFromSanctuary(transation);proxies.length=0;break;case"move":var t=proxies.splice(pos,1)[0];if(t){proxies.splice(el,0,t);transation=removeView(locatedNode,group);locatedNode=getLocatedNode(parent,data,el);parent.insertBefore(transation,locatedNode)}break;case"set":var proxy=proxies[pos];if(proxy){proxy[proxy.$itemName]=el}break;case"append":var pool=el;var callback=getBindingCallback(data.callbackElement,"data-with-sorted",data.vmodels);var keys=[];for(var key in pos){if(pos.hasOwnProperty(key)){keys.push(key)}}if(callback){var keys2=callback.call(parent,keys);if(keys2&&Array.isArray(keys2)&&keys2.length){keys=keys2}}for(var i=0,key;key=keys[i++];){lastFn=shimController(data,transation,spans,pool[key])}lastFn.parent=parent;lastFn.node=data.endRepeat||null;parent.insertBefore(transation,lastFn.node);for(var i=0,el;el=spans[i++];){scanTag(el,data.vmodels)}spans=null;break}iteratorCallback.call(data,arguments)}},html:function(val,elem,data){val=val==null?"":val;if(!elem){elem=data.element=data.node.parentNode}if(data.replaceNodes){var fragment,nodes;if(val.nodeType===11){fragment=val}else{if(val.nodeType===1||val.item){nodes=val.nodeType===1?val.childNodes:val.item?val:[];fragment=hyperspace.cloneNode(true);while(nodes[0]){fragment.appendChild(nodes[0])}}else{fragment=avalon.parseHTML(val)}}var replaceNodes=avalon.slice(fragment.childNodes);elem.insertBefore(fragment,data.replaceNodes[0]||null);for(var i=0,node;node=data.replaceNodes[i++];){elem.removeChild(node)}data.replaceNodes=replaceNodes}else{avalon.innerHTML(elem,val)}avalon.nextTick(function(){scanNodes(elem,data.vmodels)})},"if":function(val,elem,data){var placehoder=data.placehoder;if(val){if(!data.msInDocument){data.msInDocument=true;try{placehoder.parentNode.replaceChild(elem,placehoder)}catch(e){log("debug: ms-if "+e.message)}}if(rbind.test(elem.outerHTML.replace(rlt,"<").replace(rgt,">"))){scanAttr(elem,data.vmodels)}}else{if(data.msInDocument){data.msInDocument=false;elem.parentNode.replaceChild(placehoder,elem);placehoder.elem=elem;ifSanctuary.appendChild(elem)}}},on:function(callback,elem,data){var fn=data.evaluator;var args=data.args;var vmodels=data.vmodels;if(!data.hasArgs){callback=function(e){return fn.apply(0,args).call(this,e)}}else{callback=function(e){return fn.apply(this,args.concat(e))}}elem.$vmodel=vmodels[0];elem.$vmodels=vmodels;data.param=data.param.replace(/-\d+$/,"");if(typeof data.specialBind==="function"){data.specialBind(elem,callback)}else{var removeFn=avalon.bind(elem,data.param,callback)}data.rollback=function(){if(typeof data.specialUnbind==="function"){data.specialUnbind()}else{avalon.unbind(elem,data.param,removeFn)}};data.evaluator=data.handler=noop},text:function(val,elem,data){val=val==null?"":val;var node=data.node;if(data.nodeType===3){try{node.data=val}catch(e){}}else{if(!elem){elem=data.element=node.parentNode}elem.textContent=val}},visible:function(val,elem,data){elem.style.display=val?data.display:"none"},widget:noop};var bindingHandlers=avalon.bindingHandlers={attr:function(data,vmodels){var text=data.value.trim(),simple=true;if(text.indexOf(openTag)>-1&&text.indexOf(closeTag)>2){simple=false;if(rexpr.test(text)&&RegExp.rightContext===""&&RegExp.leftContext===""){simple=true;text=RegExp.$1}}data.handlerName="attr";parseExprProxy(text,vmodels,data,(simple?null:scanExpr(data.value)))},"class":function(data,vmodels){var oldStyle=data.param,text=data.value,rightExpr;data.handlerName="class";if(!oldStyle||isFinite(oldStyle)){data.param="";var noExpr=text.replace(rexprg,function(a){return Math.pow(10,a.length-1)});var colonIndex=noExpr.indexOf(":");if(colonIndex===-1){var className=text}else{className=text.slice(0,colonIndex);rightExpr=text.slice(colonIndex+1);parseExpr(rightExpr,vmodels,data);if(!data.evaluator){log("debug: ms-class '"+(rightExpr||"").trim()+"' 不存在于VM中");return false}else{data._evaluator=data.evaluator;data._args=data.args}}var hasExpr=rexpr.test(className);if(!hasExpr){data._class=className}parseExprProxy("",vmodels,data,(hasExpr?scanExpr(className):null))}else{if(data.type==="class"){parseExprProxy(text,vmodels,data)}}},checked:function(data,vmodels){data.handlerName="checked";parseExprProxy(data.value,vmodels,data)},duplex:function(data,vmodels){var elem=data.element,tagName=elem.tagName;if(typeof duplexBinding[tagName]==="function"){data.changed=getBindingCallback(elem,"data-duplex-changed",vmodels)||noop;parseExpr(data.value,vmodels,data,"duplex");if(data.evaluator&&data.args){var form=elem.form;if(form&&form.msValidate){form.msValidate(elem)}data.bound=function(type,callback){elem.addEventListener(type,callback);var old=data.rollback;data.rollback=function(){elem.removeEventListener(type,callback);old&&old()}};duplexBinding[elem.tagName](elem,data.evaluator.apply(null,data.args),data)}}},repeat:function(data,vmodels){var type=data.type,list;parseExpr(data.value,vmodels,data);if(type!=="repeat"){}var elem=data.callbackElement=data.parent=data.element;data.getter=function(){return this.evaluator.apply(0,this.args||[])};data.proxies=[];var freturn=true;try{list=data.getter();if(rcomplextype.test(getType(list))){freturn=false}}catch(e){}var template=hyperspace.cloneNode(false);if(type==="repeat"){var startRepeat=DOC.createComment("repeat-start");var endRepeat=DOC.createComment("repeat-end");data.element=data.parent=elem.parentNode;data.startRepeat=startRepeat;data.endRepeat=endRepeat;elem.removeAttribute(data.name);data.parent.replaceChild(endRepeat,elem);data.parent.insertBefore(startRepeat,endRepeat);template.appendChild(elem)}else{var node;while(node=elem.firstChild){if(node.nodeType===3&&rwhitespace.test(node.data)){elem.removeChild(node)}else{template.appendChild(node)}}}data.template=template;data.rollback=function(){bindingExecutors.repeat.call(data,"clear");var endRepeat=data.endRepeat;var parent=data.parent;parent.insertBefore(data.template,endRepeat||null);if(endRepeat){parent.removeChild(endRepeat);parent.removeChild(data.startRepeat);data.element=data.callbackElement}};var arr=data.value.split(".")||[];if(arr.length>1){arr.pop();var n=arr[0];for(var i=0,v;v=vmodels[i++];){if(v&&v.hasOwnProperty(n)&&v[n][subscribers]){v[n][subscribers].push(data);break}}}if(freturn){return}data.callbackName="data-"+type+"-rendered";data.handler=bindingExecutors.repeat;data.$outer={};var check0="$key",check1="$val";if(Array.isArray(list)){check0="$first";check1="$last"}for(var i=0,p;p=vmodels[i++];){if(p.hasOwnProperty(check0)&&p.hasOwnProperty(check1)){data.$outer=p;break}}node=template.firstChild;data.fastRepeat=!!node&&node.nodeType===1&&template.lastChild===node&&!node.attributes["ms-controller"]&&!node.attributes["ms-important"];list[subscribers]&&list[subscribers].push(data);if(!Array.isArray(list)&&type!=="each"){var pool=withProxyPool[list.$id];if(!pool){withProxyCount++;pool=withProxyPool[list.$id]={};for(var key in list){if(list.hasOwnProperty(key)&&key!=="hasOwnProperty"){(function(k,v){pool[k]=createWithProxy(k,v,{});pool[k].$watch("$val",function(val){list[k]=val})})(key,list[key])}}}data.handler("append",list,pool)}else{data.handler("add",0,list)}},html:function(data,vmodels){parseExprProxy(data.value,vmodels,data)},"if":function(data,vmodels){var elem=data.element;elem.removeAttribute(data.name);if(!data.placehoder){data.msInDocument=data.placehoder=DOC.createComment("if")}data.vmodels=vmodels;parseExprProxy(data.value,vmodels,data)},on:function(data,vmodels){var value=data.value,four="$event";if(value.indexOf("(")>0&&value.indexOf(")")>-1){var matched=(value.match(rdash)||["",""])[1].trim();if(matched===""||matched==="$event"){four=void 0;value=value.replace(rdash,"")}}else{four=void 0}data.hasArgs=four;parseExprProxy(value,vmodels,data,four)},visible:function(data,vmodels){var elem=data.element;if(!supportDisplay&&!root.contains(elem)){var display=parseDisplay(elem.tagName)}display=display||avalon(elem).css("display");data.display=display==="none"?parseDisplay(elem.tagName):display;parseExprProxy(data.value,vmodels,data)},widget:function(data,vmodels){var args=data.value.match(rword);var elem=data.element;var widget=args[0];if(args[1]==="$"||!args[1]){args[1]=widget+setTimeout("1")}data.value=args.join(",");var constructor=avalon.ui[widget];if(typeof constructor==="function"){vmodels=elem.vmodels||vmodels;var optName=args[2]||widget;for(var i=0,v;v=vmodels[i++];){if(v.hasOwnProperty(optName)&&typeof v[optName]==="object"){var nearestVM=v;break}}if(nearestVM){var vmOptions=nearestVM[optName];vmOptions=vmOptions.$model||vmOptions;var id=vmOptions[widget+"Id"];if(typeof id==="string"){args[1]=id}}var widgetData=avalon.getWidgetData(elem,args[0]);data[widget+"Id"]=args[1];data[widget+"Options"]=avalon.mix({},constructor.defaults,vmOptions||{},widgetData);elem.removeAttribute("ms-widget");var vmodel=constructor(elem,data,vmodels)||{};data.evaluator=noop;elem.msData["ms-widget-id"]=vmodel.$id||"";if(vmodel.hasOwnProperty("$init")){vmodel.$init()}if(vmodel.hasOwnProperty("$remove")){var offTree=function(){vmodel.$remove();elem.msData={};delete VMODELS[vmodel.$id]};if(supportMutationEvents){elem.addEventListener("DOMNodeRemoved",function(e){if(e.target===this&&!this.msRetain){offTree()}})}else{elem.offTree=offTree;launchImpl(elem)}}}else{if(vmodels.length){elem.vmodels=vmodels}}}};var supportMutationEvents=DOC.implementation.hasFeature("MutationEvents","2.0");"hover,active".replace(rword,function(method){bindingHandlers[method]=bindingHandlers["class"]});"with,each".replace(rword,function(name){bindingHandlers[name]=bindingHandlers.repeat});"disabled,enabled,readonly,selected".replace(rword,function(name){bindingHandlers[name]=bindingHandlers.checked});bindingHandlers.data=bindingHandlers.text=bindingHandlers.html;"title,alt,src,value,css,include,href".replace(rword,function(name){bindingHandlers[name]=bindingHandlers.attr});var duplexBinding=bindingHandlers.duplex;duplexBinding.INPUT=function(element,evaluator,data){var fixType=data.param,bound=data.bound,type=element.type,$elem=avalon(element),firstTigger=false,composing=false,callback=function(value){firstTigger=true;data.changed.call(this,value)},compositionStart=function(){composing=true},compositionEnd=function(){composing=false},updateVModel=function(){if(composing){return}var val=element.oldValue=element.value;if($elem.data("duplex-observe")!==false){evaluator(val);callback.call(element,val)}};data.handler=function(){var curValue=evaluator();if(curValue!==element.value){element.value=curValue}};if(type==="checkbox"&&fixType==="radio"){type="radio"}if(type==="radio"){data.handler=function(){element.oldChecked=element.checked=/bool|text/.test(fixType)?evaluator()+""===element.value:!!evaluator()};updateVModel=function(){if($elem.data("duplex-observe")!==false){var val=element.value;if(fixType==="text"){evaluator(val)}else{if(fixType==="bool"){val=val==="true";evaluator(val)}else{val=!element.oldChecked;evaluator(val);element.checked=val}}callback.call(element,val)}};bound(fixType?"change":"mousedown",updateVModel)}else{if(type==="checkbox"){updateVModel=function(){if($elem.data("duplex-observe")!==false){var method=element.checked?"ensure":"remove";var array=evaluator();if(Array.isArray(array)){avalon.Array[method](array,element.value)}else{avalon.error("ms-duplex位于checkbox时要求对应一个数组")}callback.call(element,array)}};data.handler=function(){var array=[].concat(evaluator());element.checked=array.indexOf(element.value)>=0};bound("change",updateVModel)}else{var event=element.attributes["data-duplex-event"]||element.attributes["data-event"]||{};event=event.value;if(event==="change"){bound("change",updateVModel)}else{bound("input",updateVModel);bound("compositionstart",compositionStart);bound("compositionend",compositionEnd)}}}element.oldValue=element.value;element.onTree=onTree;launch(element);registerSubscriber(data);var timer=setTimeout(function(){if(!firstTigger){callback.call(element,element.value)}clearTimeout(timer)},31)};var TimerID,ribbon=[],launch=noop;function onTree(){if(!this.disabled&&this.oldValue!==this.value){avalon.fire(this,"input")}}function ticker(){for(var n=ribbon.length-1;n>=0;n--){var el=ribbon[n];if(avalon.contains(root,el)){el.onTree&&el.onTree()}else{if(!el.msRetain){el.offTree&&el.offTree();ribbon.splice(n,1)}}}if(!ribbon.length){clearInterval(TimerID)}}function launchImpl(el){if(ribbon.push(el)===1){TimerID=setInterval(ticker,30)}}function newSetter(newValue){oldSetter.call(this,newValue);if(newValue!==this.oldValue){avalon.fire(this,"input")}}try{var inputProto=HTMLInputElement.prototype;var oldSetter=Object.getOwnPropertyDescriptor(inputProto,"value").set;Object.defineProperty(inputProto,"value",{set:newSetter})}catch(e){launch=launchImpl}duplexBinding.SELECT=function(element,evaluator,data){var $elem=avalon(element);function updateVModel(){if($elem.data("duplex-observe")!==false){var val=$elem.val();if(val+""!==element.oldValue){evaluator(val);element.oldValue=val+""}data.changed.call(element,val)}}data.handler=function(){var curValue=evaluator();curValue=curValue&&curValue.$model||curValue;curValue=Array.isArray(curValue)?curValue.map(String):curValue+"";if(curValue+""!==element.oldValue){$elem.val(curValue);element.oldValue=curValue+""}};data.bound("change",updateVModel);var innerHTML=NaN;var id=setInterval(function(){var currHTML=element.innerHTML;if(currHTML===innerHTML){clearInterval(id);registerSubscriber(data)}else{innerHTML=currHTML}},20)};duplexBinding.TEXTAREA=duplexBinding.INPUT;var eventHooks=avalon.eventHooks;if(!("onmouseenter" in root)){avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(origType,fixType){eventHooks[origType]={type:fixType,deel:function(elem,fn){return function(e){var t=e.relatedTarget;if(!t||(t!==elem&&!(elem.compareDocumentPosition(t)&16))){delete e.type;e.type=origType;return fn.call(elem,e)}}}}})}avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(construct,fixType){if(window[construct]&&!eventHooks.animationend){eventHooks.animationend={type:fixType}}});if(document.onmousewheel===void 0){eventHooks.mousewheel={type:"DOMMouseScroll",deel:function(elem,fn){return function(e){e.wheelDelta=e.detail>0?-120:120;Object.defineProperty(e,"type",{value:"mousewheel"});fn.call(elem,e)}}}}function Collection(model){var array=[];array.$id=generateID();array[subscribers]=[];array.$model=model;array.$events={};array._=modelFactory({length:model.length});array._.$watch("length",function(a,b){array.$fire("length",a,b)});for(var i in Observable){array[i]=Observable[i]}avalon.mix(array,CollectionPrototype);return array}var _splice=ap.splice;var CollectionPrototype={_splice:_splice,_add:function(arr,pos){var oldLength=this.length;pos=typeof pos==="number"?pos:oldLength;var added=[];for(var i=0,n=arr.length;i<n;i++){added[i]=convert(arr[i])}_splice.apply(this,[pos,0].concat(added));notifySubscribers(this,"add",pos,added);if(!this._stopFireLength){return this._.length=this.length}},_del:function(pos,n){var ret=this._splice(pos,n);if(ret.length){notifySubscribers(this,"del",pos,n);if(!this._stopFireLength){this._.length=this.length}}return ret},push:function(){ap.push.apply(this.$model,arguments);var n=this._add(arguments);notifySubscribers(this,"index",n>2?n-2:0);return n},pushArray:function(array){return this.push.apply(this,array)},unshift:function(){ap.unshift.apply(this.$model,arguments);var ret=this._add(arguments,0);notifySubscribers(this,"index",arguments.length);return ret},shift:function(){var el=this.$model.shift();this._del(0,1);notifySubscribers(this,"index",0);return el},pop:function(){var el=this.$model.pop();this._del(this.length-1,1);return el},splice:function(a,b){a=resetNumber(a,this.length);var removed=_splice.apply(this.$model,arguments),ret=[];this._stopFireLength=true;if(removed.length){ret=this._del(a,removed.length);if(arguments.length<=2){notifySubscribers(this,"index",0)}}if(arguments.length>2){this._add(aslice.call(arguments,2),a)}this._stopFireLength=false;this._.length=this.length;return ret},contains:function(el){return this.indexOf(el)!==-1},size:function(){return this._.length},remove:function(el){return this.removeAt(this.indexOf(el))},removeAt:function(index){return index>=0?this.splice(index,1):[]},clear:function(){this.$model.length=this.length=this._.length=0;notifySubscribers(this,"clear",0);return this},removeAll:function(all){if(Array.isArray(all)){all.forEach(function(el){this.remove(el)},this)}else{if(typeof all==="function"){for(var i=this.length-1;i>=0;i--){var el=this[i];if(all(el,i)){this.splice(i,1)}}}else{this.clear()}}},ensure:function(el){if(!this.contains(el)){this.push(el)}return this},set:function(index,val){if(index>=0){var valueType=getType(val);if(val&&val.$model){val=val.$model}var target=this[index];if(valueType==="object"){for(var i in val){if(target.hasOwnProperty(i)){target[i]=val[i]}}}else{if(valueType==="array"){target.clear().push.apply(target,val)}else{if(target!==val){this[index]=val;this.$model[index]=val;notifySubscribers(this,"set",index,val)}}}}return this}};"sort,reverse".replace(rword,function(method){CollectionPrototype[method]=function(){var aaa=this.$model,bbb=aaa.slice(0),sorted=false;ap[method].apply(aaa,arguments);for(var i=0,n=bbb.length;i<n;i++){var a=aaa[i],b=bbb[i];if(!isEqual(a,b)){sorted=true;var index=bbb.indexOf(a,i);var remove=this._splice(index,1)[0];var remove2=bbb.splice(index,1)[0];this._splice(i,0,remove);bbb.splice(i,0,remove2);notifySubscribers(this,"move",index,i)}}bbb=void 0;if(sorted){notifySubscribers(this,"index",0)}return this}});function convert(val){var type=getType(val);if(rcomplextype.test(type)){val=val.$id?val:modelFactory(val,val)}return val}var queryComments=function(parent){var tw=DOC.createTreeWalker(parent,NodeFilter.SHOW_COMMENT,null,null),comment,ret=[];while(comment=tw.nextNode()){ret.push(comment)}return ret};var deleteRange=DOC.createRange();function expelFromSanctuary(parent){var comments=queryComments(parent);for(var i=0,comment;comment=comments[i++];){if(comment.nodeValue=="ms-if"){cinerator.appendChild(comment.elem)}}while(comment=parent.firstChild){cinerator.appendChild(comment)}cinerator.innerHTML=""}function iteratorCallback(args){var callback=getBindingCallback(this.callbackElement,this.callbackName,this.vmodels);if(callback){var parent=this.parent;checkScan(parent,function(){callback.apply(parent,args)})}}function shimController(data,transation,spans,proxy){var tview=data.template.cloneNode(true);var id=proxy.$id;var span=tview.firstChild;if(!data.fastRepeat){span=DOC.createElement("msloop");span.style.display="none";span.appendChild(tview)}span.setAttribute("ms-controller",id);spans.push(span);transation.appendChild(span);proxy.$outer=data.$outer;VMODELS[id]=proxy;function fn(){delete VMODELS[id];data.group=1;if(!data.fastRepeat){data.group=span.childNodes.length;span.parentNode.removeChild(span);while(span.firstChild){transation.appendChild(span.firstChild)}if(fn.node!==void 0){fn.parent.insertBefore(transation,fn.node)}}}return span.patchRepeat=fn}function getLocatedNode(parent,data,pos){if(data.startRepeat){var ret=data.startRepeat,end=data.endRepeat;pos+=1;for(var i=0;i<pos;i++){ret=ret.nextSibling;if(ret==end){return end}}return ret}else{return parent.childNodes[data.group*pos]||null}}function removeView(node,group,n){var length=group*(n||1);var view=hyperspace;while(--length>=0){var nextSibling=node.nextSibling;view.appendChild(node);node=nextSibling;if(!node){break}}return view}var watchEachOne=oneObject("$index,$first,$last");function createWithProxy(key,val,$outer){var proxy=modelFactory({$key:key,$outer:$outer,$val:val},0,{$val:1,$key:1});proxy.$id="$proxy$with"+Math.random();return proxy}var eachProxyPool=[];function getEachProxy(index,item,data,last){var param=data.param||"el",proxy;var source={$remove:function(){return data.getter().removeAt(proxy.$index)},$itemName:param,$index:index,$outer:data.$outer,$first:index===0,$last:index===last};source[param]=item;for(var i=0,n=eachProxyPool.length;i<n;i++){var proxy=eachProxyPool[i];if(proxy.hasOwnProperty(param)){for(var i in source){proxy[i]=source[i]}eachProxyPool.splice(i,1);return proxy}}var type=avalon.type(item);if(type==="object"||type==="function"){source.$skipArray=[param]}proxy=modelFactory(source,0,watchEachOne);proxy.$id="$proxy$"+data.type+Math.random();return proxy}function recycleEachProxy(proxy){var obj=proxy.$accessors,name=proxy.$itemName;["$index","$last","$first"].forEach(function(prop){obj[prop][subscribers].length=0});if(proxy[name][subscribers]){proxy[name][subscribers].length=0}if(eachProxyPool.unshift(proxy)>kernel.maxRepeatSize){eachProxyPool.pop()}}var rscripts=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim;var raimg=/^<(a|img)\s/i;var ron=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g;var ropen=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/ig;var rjavascripturl=/\s+(src|href)(?:=("javascript[^"]*"|'javascript[^']*'))?/ig;var rsurrogate=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var rnoalphanumeric=/([^\#-~| |!])/g;var filters=avalon.filters={uppercase:function(str){return str.toUpperCase()},lowercase:function(str){return str.toLowerCase()},truncate:function(target,length,truncation){length=length||30;truncation=truncation===void (0)?"...":truncation;return target.length>length?target.slice(0,length-truncation.length)+truncation:String(target)},sanitize:window.toStaticHTML?toStaticHTML.bind(window):function(str){return str.replace(rscripts,"").replace(ropen,function(a,b){if(raimg.test(a)){a=a.replace(rjavascripturl,"")}return a.replace(ron," ").replace(/\s+/g," ")})},camelize:camelize,escape:function(html){return String(html).replace(/&/g,"&amp;").replace(rsurrogate,function(value){var hi=value.charCodeAt(0);var low=value.charCodeAt(1);return"&#"+(((hi-55296)*1024)+(low-56320)+65536)+";"}).replace(rnoalphanumeric,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(number,symbol){symbol=symbol||"￥";return symbol+avalon.filters.number(number)},number:function(number,decimals,dec_point,thousands_sep){number=(number+"").replace(/[^0-9+\-Ee.]/g,"");var n=!isFinite(+number)?0:+number,prec=!isFinite(+decimals)?0:Math.abs(decimals),sep=thousands_sep||",",dec=dec_point||".",s="",toFixedFix=function(n,prec){var k=Math.pow(10,prec);return""+Math.round(n*k)/k};s=(prec?toFixedFix(n,prec):""+Math.round(n)).split(".");if(s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)}if((s[1]||"").length<prec){s[1]=s[1]||"";s[1]+=new Array(prec-s[1].length+1).join("0")}return s.join(dec)}};new function(){function toInt(str){return parseInt(str,10)}function padNumber(num,digits,trim){var neg="";if(num<0){neg="-";num=-num}num=""+num;while(num.length<digits){num="0"+num}if(trim){num=num.substr(num.length-digits)}return neg+num}function dateGetter(name,size,offset,trim){return function(date){var value=date["get"+name]();if(offset>0||value>-offset){value+=offset}if(value===0&&offset===-12){value=12}return padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name]();var get=(shortForm?("SHORT"+name):name).toUpperCase();return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset();var paddedZone=(zone>=0)?"+":"";paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2);return paddedZone}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}var DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,true),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",true),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",true),a:ampmGetter,Z:timeZoneGetter};var DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\d+$/;var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;if(match[9]){tzHour=toInt(match[9]+match[10]);tzMin=toInt(match[9]+match[11])}dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour;var m=toInt(match[5]||0)-tzMin;var s=toInt(match[6]||0);var ms=Math.round(parseFloat("0."+(match[7]||0))*1000);timeSetter.call(date,h,m,s,ms);return date}return string}var rfixFFDate=/^(\d+)-(\d+)-(\d{4})$/;var rfixIEDate=/^(\d+)\s+(\d+),(\d{4})$/;filters.date=function(date,format){var locate=filters.date.locate,text="",parts=[],fn,match;format=format||"mediumDate";format=locate[format]||format;if(typeof date==="string"){if(NUMBER_STRING.test(date)){date=toInt(date)}else{var trimDate=date.trim();if(trimDate.match(rfixFFDate)||trimDate.match(rfixIEDate)){date=RegExp.$3+"/"+RegExp.$1+"/"+RegExp.$2}date=jsonStringToDate(date)}date=new Date(date)}if(typeof date==="number"){date=new Date(date)}if(getType(date)!=="date"){return}while(format){match=DATE_FORMATS_SPLIT.exec(format);if(match){parts=parts.concat(match.slice(1));format=parts.pop()}else{parts.push(format);format=null}}parts.forEach(function(value){fn=DATE_FORMATS[value];text+=fn?fn(date,locate):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return text};var locate={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{"0":"周日","1":"周一","2":"周二","3":"周三","4":"周四","5":"周五","6":"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d ah:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"ah:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};locate.SHORTMONTH=locate.MONTH;filters.date.locate=locate};var innerRequire;var modules=avalon.modules={"ready!":{exports:avalon},avalon:{exports:avalon,state:2}};new function(){var loadings=[];var factorys=[];var basepath;function cleanUrl(url){return(url||"").replace(/[?#].*/,"")}plugins.js=function(url,shim){var id=cleanUrl(url);if(!modules[id]){modules[id]={id:id,exports:{}};if(shim){innerRequire(shim.deps||"",function(){loadJS(url,id,function(){modules[id].state=2;if(shim.exports){modules[id].exports=typeof shim.exports==="function"?shim.exports():window[shim.exports]}innerRequire.checkDeps()})})}else{loadJS(url,id)}}return id};plugins.css=function(url){var id=url.replace(/(#.+|\W)/g,"");if(!DOC.getElementById(id)){var node=DOC.createElement("link");node.rel="stylesheet";node.href=url;node.id=id;head.insertBefore(node,head.firstChild)}};plugins.css.ext=".css";plugins.js.ext=".js";plugins.text=function(url){var xhr=new XMLHttpRequest;var id=url.replace(/[?#].*/,"");modules[id]={};xhr.onload=function(){modules[id].state=2;modules[id].exports=xhr.responseText;innerRequire.checkDeps()};xhr.onerror=function(){avalon.error(url+" 对应资源不存在或没有开启 CORS")};xhr.open("GET",url,true);xhr.withCredentials=true;xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.send();return id};if("import" in DOC.createElement("link")){plugins.text=function(url){var id=url.replace(/[?#].*/,"");modules[id]={};var link=DOC.createElement("link");link.rel="import";link.href=url;link.onload=function(){modules[id].state=2;var content=this["import"];if(content){modules[id].exports=content.documentElement.outerHTML;avalon.require.checkDeps()}onerror(0,content)};function onerror(a,b){b&&avalon.error(url+"对应资源不存在或没有开启 CORS");setTimeout(function(){head.removeChild(link)})}link.onerror=onerror;head.appendChild(link);return id}}var cur=getCurrentScript(true);if(!cur){cur=avalon.slice(document.scripts).pop().src}var url=cleanUrl(cur);basepath=kernel.base=url.slice(0,url.lastIndexOf("/")+1);function getCurrentScript(base){var stack;try{a.b.c()}catch(e){stack=e.stack}if(stack){stack=stack.split(/[@ ]/g).pop();stack=stack[0]==="("?stack.slice(1,-1):stack.replace(/\s/,"");return stack.replace(/(:\d+)?:\d+$/i,"")}var nodes=(base?DOC:head).getElementsByTagName("script");for(var i=nodes.length,node;node=nodes[--i];){if((base||node.className===subscribers)&&node.readyState==="interactive"){return node.className=node.src}}}function checkCycle(deps,nick){for(var id in deps){if(deps[id]==="司徒正美"&&modules[id].state!==2&&(id===nick||checkCycle(modules[id].deps,nick))){return true}}}function checkDeps(){loop:for(var i=loadings.length,id;id=loadings[--i];){var obj=modules[id],deps=obj.deps;for(var key in deps){if(ohasOwn.call(deps,key)&&modules[key].state!==2){continue loop}}if(obj.state!==2){loadings.splice(i,1);fireFactory(obj.id,obj.args,obj.factory);checkDeps()}}}function checkFail(node,onError){var id=cleanUrl(node.src);node.onload=node.onerror=null;if(onError){setTimeout(function(){head.removeChild(node)});log("debug: 加载 "+id+" 失败"+onError+" "+(!modules[id].state))}else{return true}}var rdeuce=/\/\w+\/\.\./;function loadResources(url,parent,ret,shim){if(url==="ready!"||(modules[url]&&modules[url].state===2)){return url}var plugin;url=url.replace(/^\w+!/,function(a){plugin=a.slice(0,-1);return""});plugin=plugin||"js";plugin=plugins[plugin]||noop;if(typeof kernel.shim[url]==="object"){shim=kernel.shim[url]}if(kernel.paths[url]){url=kernel.paths[url]}if(/^(\w+)(\d)?:.*/.test(url)){ret=url}else{parent=parent.substr(0,parent.lastIndexOf("/"));var tmp=url.charAt(0);if(tmp!=="."&&tmp!=="/"){ret=basepath+url}else{if(url.slice(0,2)==="./"){ret=parent+url.slice(1)}else{if(url.slice(0,2)===".."){ret=parent+"/"+url;while(rdeuce.test(ret)){ret=ret.replace(rdeuce,"")}}else{if(tmp==="/"){ret=parent+url}else{avalon.error("不符合模块标识规则: "+url)}}}}}url=cleanUrl(ret);var ext=plugin.ext;if(ext){if(url.slice(0-ext.length)!==ext){ret+=ext}}if(kernel.nocache){ret+=(ret.indexOf("?")===-1?"?":"&")+Date.now()}return plugin(ret,shim)}function loadJS(url,id,callback){var node=DOC.createElement("script");node.className=subscribers;node.onload=function(){var factory=factorys.pop();factory&&factory.delay(id);if(callback){callback()}log("debug: 已成功加载 "+url)};node.onerror=function(){checkFail(node,true)};node.src=url;head.appendChild(node);log("debug: 正准备加载 "+url)}innerRequire=avalon.require=function(list,factory,parent){var deps={},args=[],dn=0,cn=0,id=parent||"callback"+setTimeout("1");parent=parent||basepath;String(list).replace(rword,function(el){var url=loadResources(el,parent);if(url){dn++;if(modules[url]&&modules[url].state===2){cn++}if(!deps[url]){args.push(url);deps[url]="司徒正美"}}});modules[id]={id:id,factory:factory,deps:deps,args:args,state:1};if(dn===cn){fireFactory(id,args,factory)}else{loadings.unshift(id)}checkDeps()};innerRequire.define=function(id,deps,factory){var args=avalon.slice(arguments);if(typeof id==="string"){var _id=args.shift()}if(typeof args[0]==="function"){args.unshift([])}var name=modules[_id]&&modules[_id].state>=1?_id:cleanUrl(getCurrentScript());if(!modules[name]&&_id){modules[name]={id:name,factory:factory,state:1}}factory=args[1];factory.id=_id;factory.delay=function(d){args.push(d);var isCycle=true;try{isCycle=checkCycle(modules[d].deps,d)}catch(e){}if(isCycle){avalon.error(d+"模块与之前的模块存在循环依赖，请不要直接用script标签引入"+d+"模块")}delete factory.delay;innerRequire.apply(null,args)};if(name){factory.delay(name,args)}else{factorys.push(factory)}};innerRequire.define.amd=modules;function fireFactory(id,deps,factory){for(var i=0,array=[],d;d=deps[i++];){array.push(modules[d].exports)}var module=Object(modules[id]),ret=factory.apply(window,array);module.state=2;if(ret!==void 0){modules[id].exports=ret}return ret}innerRequire.config=kernel;innerRequire.checkDeps=checkDeps};var IE11touch=navigator.pointerEnabled;var IE9_10touch=navigator.msPointerEnabled;$.av=avalon;function fireReady(){modules["ready!"].state=2;innerRequire.checkDeps();fireReady=noop}if(DOC.readyState==="complete"){setTimeout(fireReady)}else{DOC.addEventListener("DOMContentLoaded",fireReady);window.addEventListener("load",fireReady)}avalon.ready=function(fn){innerRequire("ready!",fn)};avalon.config({loader:false});var msSelector="[ms-controller],[ms-important]";avalon.ready(function(){var elems=DOC.querySelectorAll(msSelector),nodes=[];for(var i=0,elem;elem=elems[i++];){if(!elem.__root__){var array=elem.querySelectorAll(msSelector);for(var j=0,el;el=array[j++];){el.__root__=true}nodes.push(elem)}}for(var i=0,elem;elem=nodes[i++];){avalon.scan(elem)}})})($$$,document);(function(b){b.ajax=function(c){var g=false;var l=b.extend({},{type:"POST",url:"",dataType:"JSON",data:{},timeout:0,success:function(){},error:function(){}},c);if(!l.url){return}if(/\#/.test(l.url)){l.url=l.url.replace(/\#[\s\S]+$/,"")}var k=new XMLHttpRequest();function d(n){for(var m in n){return false}return true}function f(n){var o=[];for(var m in n){if(m=="method"||m=="timeout"||m=="async"||m=="ajaxUrl"||m=="url"){continue}else{return b.param(l.data)}}}var e=d(l.data)?"":f(l.data);var h=l.url+(l.url.indexOf("?")==-1?"?":"&")+(/POST/i.test(l.type)?("noCache="+(+new Date)):(!!e?e+"&noCache="+(+new Date):e+"noCache="+(+new Date)));var j=null;k.open(l.type,h);l.timeout=typeof l.timeout==="boolean"?(l.timeout===true?5000:false):(typeof l.timeout==="string"||typeof l.timeout==="number"?(parseInt(l.timeout,10)==0||parseInt(l.timeout,10)<=5000?false:parseInt(l.timeout,10)):parseInt(l.timeout,10));if(!!l.timeout){j=setTimeout(function(){if(k.readyState!=4){g=true;k.abort();var m=confirm("请求超时\n点击确定自动刷新本页\n点击取消手动刷新");if(m){window.location.reload()}clearTimeout(j)}},l.timeout)}k.onreadystatechange=function(){try{if(k.readyState==4){if(!g&&k.status==200){if(l.success){var m=k.responseText;if(/JSON/i.test(l.dataType)){if(typeof k.responseText=="string"&&k.responseText!=""){try{m=JSON.parse(m);l.success(m)}catch(n){window.console?console.log("服务器返回JSON错误"):alert("服务器返回JSON错误")}}}else{l.success(m)}}}else{if(l.error){l.error(k)}}}}catch(n){window.console&&console.log(n)}};k.setRequestHeader("X-Requested-With","XMLHttpRequest");if(/post/i.test(l.type)){k.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");k.send(e)}else{k.send(null)}}})($$$);(function(e,j){
/*! 
doT.js
2011, Laura Doktorova, https://github.com/olado/doT
Licensed under the MIT license.
templateSettings: {
	evaluate:    /\{\{([\s\S]+?(\}?)+)\}\}/g,
	interpolate: /\{\{=([\s\S]+?)\}\}/g,
	encode:      /\{\{!([\s\S]+?)\}\}/g,
	use:         /\{\{#([\s\S]+?)\}\}/g,
	useParams:   /(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,
	define:      /\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,
	defineParams:/^\s*([\w$]+):([\s\S]+)/,
	conditional: /\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,
	iterate:     /\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,
	varname:	'it',
	strip:		true,
	append:		true,
	selfcontained: false
}
*/
;"use strict";var h={version:"1.0.1",templateSettings:{evaluate:/\{\%([\s\S]+?)\%\}/g,interpolate:/\{\%=([\s\S]+?)\%\}/g,encode:/\{\%!([\s\S]+?)\%\}/g,use:/\{\%#([\s\S]+?)\%\}/g,define:/\{\%##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\%\}/g,conditional:/\{\%\?(\?)?\s*([\s\S]*?)\s*\%\}/g,iterate:/\{\%~\s*(?:\%\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\%\})/g,varname:"it",strip:true,append:true,selfcontained:false},template:undefined,compile:undefined},b;
/*!if (typeof module !== 'undefined' && module.exports) {
	module.exports = doT;
} else if (typeof define === 'function' && define.amd) {
	define(function(){return doT;});
} else {
	global = (function(){ return this || (0,eval)('this'); }());
	global.doT = doT;
}*/
;function g(){var l={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},m=/&(?!#?\w+;)|<|>|"|'|\//g;return function(){return this?this.replace(m,function(n){return l[n]||n}):this}}String.prototype.encodeHTML=g();var d={append:{start:"'+(",end:")+'",endencode:"||'').toString().encodeHTML()+'"},split:{start:"';out+=(",end:");out+='",endencode:"||'').toString().encodeHTML();out+='"}},k=/$^/;function c(n,m,l){return((typeof m==="string")?m:m.toString()).replace(n.define||k,function(o,q,p,r){if(q.indexOf("def.")===0){q=q.substring(4)}if(!(q in l)){if(p===":"){if(n.defineParams){r.replace(n.defineParams,function(s,u,t){l[q]={arg:u,text:t}})}if(!(q in l)){l[q]=r}}else{new Function("def","def['"+q+"']="+r)(l)}}return""}).replace(n.use||k,function(o,q){if(n.useParams){q=q.replace(n.useParams,function(r,t,w,v){if(l[w]&&l[w].arg&&v){var u=(w+":"+v).replace(/'|\\/g,"_");l.__exp=l.__exp||{};l.__exp[u]=l[w].text.replace(new RegExp("(^|[^\\w$])"+l[w].arg+"([^\\w$])","g"),"$1"+v+"$2");return t+"def.__exp['"+u+"']"}})}var p=new Function("def","return "+q)(l);return p?c(n,p,l):p})}function f(l){return l.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}h.template=function(s,q,n){q=q||h.templateSettings;var l=q.append?d.append:d.split,t,m=0,p,r=(q.use||q.define)?c(q,s,n||{}):s;r=("var out='"+(q.strip?r.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):r).replace(/'|\\/g,"\\$&").replace(q.interpolate||k,function(u,v){return l.start+f(v)+l.end}).replace(q.encode||k,function(u,v){t=true;return l.start+f(v)+l.endencode}).replace(q.conditional||k,function(u,w,v){return w?(v?"';}else if("+f(v)+"){out+='":"';}else{out+='"):(v?"';if("+f(v)+"){out+='":"';}out+='")}).replace(q.iterate||k,function(u,v,x,w){if(!v){return"';} } out+='"}m+=1;p=w||"i"+m;v=f(v);return"';var arr"+m+"="+v+";if(arr"+m+"){var "+x+","+p+"=-1,l"+m+"=arr"+m+".length-1;while("+p+"<l"+m+"){"+x+"=arr"+m+"["+p+"+=1];out+='"}).replace(q.evaluate||k,function(u,v){return"';"+f(v)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|\}|^|\{)out\+=''\+/g,"$1out+=");if(t&&q.selfcontained){r="String.prototype.encodeHTML=("+g.toString()+"());"+r}try{return new Function(q.varname,r)}catch(o){if(typeof console!=="undefined"){console.log("Could not create a template function: "+r)}throw o}};h.compile=function(l,m){return h.template(l,null,m)};e.doT=function(l,m){if(l&&m){return h.template(l).apply(null,[m])}}})($$$,window);(function(f,k,l,d){var c=k.requestAnimationFrame||k.webkitRequestAnimationFrame||k.mozRequestAnimationFrame||k.oRequestAnimationFrame||k.msRequestAnimationFrame||function(q){k.setTimeout(q,1000/60)};var o=k.navigator.userAgent;var h=o.match(/shouxiner[\s\S]+$/);var n=h?h[1]:null;var g=(f.os.ios||f.os.ios7||f.os.iphone)||(n?(/ios/i.test(n)):false);var b=(f.os.android||f.os.androidICS)||(n?(/android/i.test(n)):false);var m=(function(){var u={};var v=l.createElement("div").style;var s=(function(){var z=["t","webkitT","MozT","msT","OT"],x,y=0,w=z.length;for(;y<w;y++){x=z[y]+"ransform";if(x in v){return z[y].substr(0,z[y].length-1)}}return false})();function t(w){if(s===false){return false}if(s===""){return w}return s+w.charAt(0).toUpperCase()+w.substr(1)}u.getTime=Date.now||function q(){return new Date().getTime()};u.extend=function(y,x){for(var w in x){y[w]=x[w]}};u.addEvent=function(z,y,x,w){z.addEventListener(y,x,!!w)};u.removeEvent=function(z,y,x,w){z.removeEventListener(y,x,!!w)};u.prefixPointerEvent=function(w){return k.MSPointerEvent?"MSPointer"+w.charAt(9).toUpperCase()+w.substr(10):w};u.momentum=function(C,y,z,w,D,E){var x=C-y,A=d.abs(x)/z,F,B;E=E===undefined?0.0006:E;F=C+(A*A)/(2*E)*(x<0?-1:1);B=A/E;if(F<w){F=D?w-(D/2.5*(A/8)):w;x=d.abs(F-C);B=x/A}else{if(F>0){F=D?D/2.5*(A/8):0;x=d.abs(C)+F;B=x/A}}return{destination:d.round(F),duration:B}};var r=t("transform");u.extend(u,{hasTransform:r!==false,hasPerspective:t("perspective") in v,hasTouch:"ontouchstart" in k,hasPointer:k.PointerEvent||k.MSPointerEvent,hasTransition:t("transition") in v});u.isBadAndroid=/Android /.test(k.navigator.appVersion)&&!(/Chrome\/\d/.test(k.navigator.appVersion));u.extend(u.style={},{transform:r,transitionTimingFunction:t("transitionTimingFunction"),transitionDuration:t("transitionDuration"),transitionDelay:t("transitionDelay"),transformOrigin:t("transformOrigin")});u.hasClass=function(x,y){var w=new RegExp("(^|\\s)"+y+"(\\s|$)");return w.test(x.className)};u.addClass=function(x,y){if(u.hasClass(x,y)){return}var w=x.className.split(" ");w.push(y);x.className=w.join(" ")};u.removeClass=function(x,y){if(!u.hasClass(x,y)){return}var w=new RegExp("(^|\\s)"+y+"(\\s|$)","g");x.className=x.className.replace(w," ")};u.offset=function(w){var y=-w.offsetLeft,x=-w.offsetTop;while(w=w.offsetParent){y-=w.offsetLeft;x-=w.offsetTop}return{left:y,top:x}};u.preventDefaultException=function(y,x){for(var w in x){if(x[w].test(y[w])){return true}}return false};u.extend(u.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});u.extend(u.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(w){return w*(2-w)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(w){return d.sqrt(1-(--w*w))}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(x){var w=4;return(x=x-1)*x*((w+1)*x+w)+1}},bounce:{style:"",fn:function(w){if((w/=1)<(1/2.75)){return 7.5625*w*w}else{if(w<(2/2.75)){return 7.5625*(w-=(1.5/2.75))*w+0.75}else{if(w<(2.5/2.75)){return 7.5625*(w-=(2.25/2.75))*w+0.9375}else{return 7.5625*(w-=(2.625/2.75))*w+0.984375}}}}},elastic:{style:"",fn:function(w){var x=0.22,y=0.4;if(w===0){return 0}if(w==1){return 1}return(y*d.pow(2,-10*w)*d.sin((w-x/4)*(2*d.PI)/x)+1)}}});u.tap=function(y,w){var x=l.createEvent("Event");x.initEvent(w,true,true);x.pageX=y.pageX;x.pageY=y.pageY;y.target.dispatchEvent(x)};u.click=function(y){var x=y.target,w;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(x.tagName)){w=l.createEvent("MouseEvents");w.initMouseEvent("click",true,true,y.view,1,x.screenX,x.screenY,x.clientX,x.clientY,y.ctrlKey,y.altKey,y.shiftKey,y.metaKey,0,null);w._constructed=true;x.dispatchEvent(w)}};return u})();function j(s,q){this.wrapper=typeof s=="string"?l.querySelector(s):s;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:0.334,startX:0,startY:0,scrollY:true,topOffset:0,bottomOffset:0,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var r in q){this.options[r]=q[r]}this.translateZ=this.options.HWCompositing&&m.hasPerspective?" translateZ(0)":"";this.options.useTransition=m.hasTransition&&this.options.useTransition;this.options.useTransform=m.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?m.ease[this.options.bounceEasing]||m.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}if(this.options.shrinkScrollbars=="scale"){this.options.useTransition=false}this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;if(this.options.probeType==3){this.options.useTransition=false}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,(this.options.topOffset?this.options.startY+this.options.topOffset:this.options.startY));this.enable()}j.prototype={version:"5.1.2",_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators){this._initIndicators()}if(this.options.mouseWheel){this._initWheel()}if(this.options.snap){this._initSnap()}if(this.options.keyBindings){this._initKeys()}},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(q){if(q.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(r){if(m.eventType[r.type]!=1){if(r.button!==0){return}}if(!this.enabled||(this.initiated&&m.eventType[r.type]!==this.initiated)){return}if(this.options.preventDefault&&!m.isBadAndroid&&!m.preventDefaultException(r.target,this.options.preventDefaultException)){r.preventDefault()}var q=r.touches?r.touches[0]:r,s;this.initiated=m.eventType[r.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=m.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;s=this.getComputedPosition();this._translate(d.round(s.x),d.round(s.y));this._execEvent("scrollEnd")}else{if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=q.pageX;this.pointY=q.pageY;this._execEvent("beforeScrollStart")},_move:function(v){if(!this.enabled||m.eventType[v.type]!==this.initiated){return}if(this.options.preventDefault){v.preventDefault()}var x=v.touches?v.touches[0]:v,s=x.pageX-this.pointX,r=x.pageY-this.pointY,w=m.getTime(),q,y,u,t;this.pointX=x.pageX;this.pointY=x.pageY;this.distX+=s;this.distY+=r;u=d.abs(this.distX);t=d.abs(this.distY);if(w-this.endTime>300&&(u<10&&t<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(u>t+this.options.directionLockThreshold){this.directionLocked="h"}else{if(t>=u+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){v.preventDefault()}else{if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}}r=0}else{if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){v.preventDefault()}else{if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}}s=0}}s=this.hasHorizontalScroll?s:0;r=this.hasVerticalScroll?r:0;q=this.x+s;y=this.y+r;if(q>0||q<this.maxScrollX){q=this.options.bounce?this.x+s/3:q>0?0:this.maxScrollX}if(y>0||y<this.maxScrollY){y=this.options.bounce?this.y+r/3:y>0?0:this.maxScrollY}this.directionX=s>0?-1:s<0?1:0;this.directionY=r>0?-1:r<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(q,y);if(w-this.startTime>300){this.startTime=w;this.startX=this.x;this.startY=this.y;if(this.options.probeType==1){this._execEvent("scroll")}}if(this.options.probeType>1){this._execEvent("scroll")}},_end:function(w){if(!this.enabled||m.eventType[w.type]!==this.initiated){return}if(this.options.preventDefault&&!m.preventDefaultException(w.target,this.options.preventDefaultException)){w.preventDefault()}var y=w.changedTouches?w.changedTouches[0]:w,s,r,v=m.getTime()-this.startTime,q=d.round(this.x),B=d.round(this.y),A=d.abs(q-this.startX),z=d.abs(B-this.startY),t=0,x="";this.isInTransition=0;this.initiated=0;this.endTime=m.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(q,B);if(!this.moved){if(this.options.tap){m.tap(w,this.options.tap)}if(this.options.click){m.click(w)}this._execEvent("scrollCancel");return}if(this._events.flick&&v<200&&A<100&&z<100){this._execEvent("flick");return}if(this.options.momentum&&v<300){s=this.hasHorizontalScroll?m.momentum(this.x,this.startX,v,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:q,duration:0};r=this.hasVerticalScroll?m.momentum(this.y,this.startY,v,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:B,duration:0};q=s.destination;B=r.destination;t=d.max(s.duration,r.duration);this.isInTransition=1}if(this.options.snap){var u=this._nearestSnap(q,B);this.currentPage=u;t=this.options.snapSpeed||d.max(d.max(d.min(d.abs(q-u.x),1000),d.min(d.abs(B-u.y),1000)),300);q=u.x;B=u.y;this.directionX=0;this.directionY=0;x=this.options.bounceEasing}if(q!=this.x||B!=this.y){if(q>0||q<this.maxScrollX||B>0||B<this.maxScrollY){x=m.ease.quadratic}this.scrollTo(q,B,t,x);return}this._execEvent("scrollEnd")},_resize:function(){var q=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){q.refresh()},this.options.resizePolling)},resetPosition:function(r){var q=this.x,s=this.y;r=r||0;if(!this.hasHorizontalScroll||this.x>0){q=0}else{if(this.x<this.maxScrollX){q=this.maxScrollX}}if(!this.hasVerticalScroll||(this.options.topOffset?this.y>this.options.topOffset:this.y>0)){s=(this.options.topOffset?this.options.topOffset:0)}else{if(this.y<this.maxScrollY){s=this.maxScrollY}}if(q==this.x&&s==this.y){return false}this.scrollTo(q,s,r,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var r=this.wrapper.offsetHeight;var q=(this.options.bottomOffset?this.options.bottomOffset:0);this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;if(this.scrollerHeight>this.wrapperHeight){this.maxScrollY=this.wrapperHeight-(this.scrollerHeight+q)}else{this.maxScrollY=this.wrapperHeight-this.scrollerHeight}this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=m.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(r,q){if(!this._events[r]){this._events[r]=[]}this._events[r].push(q)},off:function(s,r){if(!this._events[s]){return}var q=this._events[s].indexOf(r);if(q>-1){this._events[s].splice(q,1)}},_execEvent:function(s){if(!this._events[s]){return}var r=0,q=this._events[s].length;if(!q){return}for(;r<q;r++){this._events[s][r].apply(this,[].slice.call(arguments,1))}},scrollBy:function(q,t,r,s){q=this.x+q;t=this.y+t;r=r||0;this.scrollTo(q,t,r,s)},scrollTo:function(q,t,r,s){s=s||m.ease.circular;this.isInTransition=this.options.useTransition&&r>0;if(!r||(this.options.useTransition&&s.style)){this._transitionTimingFunction(s.style);this._transitionTime(r);this._translate(q,t)}else{this._animate(q,t,r,s.fn)}},scrollToElement:function(r,s,q,v,u){r=r.nodeType?r:this.scroller.querySelector(r);if(!r){return}var t=m.offset(r);t.left-=this.wrapperOffset.left;t.top-=this.wrapperOffset.top;if(q===true){q=d.round(r.offsetWidth/2-this.wrapper.offsetWidth/2)}if(v===true){v=d.round(r.offsetHeight/2-this.wrapper.offsetHeight/2)}t.left-=q||0;t.top-=v||0;t.left=t.left>0?0:t.left<this.maxScrollX?this.maxScrollX:t.left;t.top=t.top>0?0:t.top<this.maxScrollY?this.maxScrollY:t.top;s=s===undefined||s===null||s==="auto"?d.max(d.abs(this.x-t.left),d.abs(this.y-t.top)):s;this.scrollTo(t.left,t.top,s,u)},_transitionTime:function(r){r=r||0;this.scrollerStyle[m.style.transitionDuration]=r+"ms";if(!r&&m.isBadAndroid){this.scrollerStyle[m.style.transitionDuration]="0.001s"}if(this.indicators){for(var q=this.indicators.length;q--;){this.indicators[q].transitionTime(r)}}},_transitionTimingFunction:function(r){this.scrollerStyle[m.style.transitionTimingFunction]=r;if(this.indicators){for(var q=this.indicators.length;q--;){this.indicators[q].transitionTimingFunction(r)}}},_translate:function(q,s){if(this.options.useTransform){if(g){this.scrollerStyle[m.style.transform]="translate("+q+"px,"+s+"px)"+this.translateZ}else{this.scrollerStyle.top=s+"px";this.scrollerStyle.left=q+"px"}}else{q=d.round(q);s=d.round(s);this.scrollerStyle.left=q+"px";this.scrollerStyle.top=s+"px"}this.x=q;this.y=s;if(this.indicators){for(var r=this.indicators.length;r--;){this.indicators[r].updatePosition()}}},_initEvents:function(q){var r=q?m.removeEvent:m.addEvent,s=this.options.bindToWrapper?this.wrapper:k;r(k,"orientationchange",this);r(k,"resize",this);if(this.options.click){r(this.wrapper,"click",this,true)}if(!this.options.disableMouse){r(this.wrapper,"mousedown",this);r(s,"mousemove",this);r(s,"mousecancel",this);r(s,"mouseup",this)}if(m.hasPointer&&!this.options.disablePointer){r(this.wrapper,m.prefixPointerEvent("pointerdown"),this);r(s,m.prefixPointerEvent("pointermove"),this);r(s,m.prefixPointerEvent("pointercancel"),this);r(s,m.prefixPointerEvent("pointerup"),this)}if(m.hasTouch&&!this.options.disableTouch){r(this.wrapper,"touchstart",this);r(s,"touchmove",this);r(s,"touchcancel",this);r(s,"touchend",this)}r(this.scroller,"transitionend",this);r(this.scroller,"webkitTransitionEnd",this);r(this.scroller,"oTransitionEnd",this);r(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var r=k.getComputedStyle(this.scroller,null),q,s;if(this.options.useTransform){r=r[m.style.transform].split(")")[0].split(", ");q=+(r[12]||r[4]);s=+(r[13]||r[5])}else{q=+r.left.replace(/[^-\d.]/g,"");s=+r.top.replace(/[^-\d.]/g,"")}return{x:q,y:s}},_initIndicators:function(){var s=this.options.interactiveScrollbars,u=typeof this.options.scrollbars!="string",w=[],r;var v=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){r={el:e("v",s,this.options.scrollbars),interactive:s,defaultScrollbars:true,customStyle:u,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(r.el);w.push(r)}if(this.options.scrollX){r={el:e("h",s,this.options.scrollbars),interactive:s,defaultScrollbars:true,customStyle:u,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(r.el);w.push(r)}}if(this.options.indicators){w=w.concat(this.options.indicators)}for(var t=w.length;t--;){this.indicators.push(new p(this,w[t]))}function q(y){if(!v.indicators){return}for(var x=v.indicators.length;x--;){y.call(v.indicators[x])}}if(this.options.fadeScrollbars){this.on("scrollEnd",function(){q(function(){this.fade()})});this.on("scrollCancel",function(){q(function(){this.fade()})});this.on("scrollStart",function(){q(function(){this.fade(1)})});this.on("beforeScrollStart",function(){q(function(){this.fade(1,true)})})}this.on("refresh",function(){q(function(){this.refresh()})});this.on("destroy",function(){q(function(){this.destroy()});delete this.indicators})},_initWheel:function(){m.addEvent(this.wrapper,"wheel",this);m.addEvent(this.wrapper,"mousewheel",this);m.addEvent(this.wrapper,"DOMMouseScroll",this);this.on("destroy",function(){m.removeEvent(this.wrapper,"wheel",this);m.removeEvent(this.wrapper,"mousewheel",this);m.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(u){if(!this.enabled){return}u.preventDefault();u.stopPropagation();var s,r,v,t,q=this;if(this.wheelTimeout===undefined){q._execEvent("scrollStart")}clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){q._execEvent("scrollEnd");q.wheelTimeout=undefined},400);if("deltaX" in u){s=-u.deltaX;r=-u.deltaY}else{if("wheelDeltaX" in u){s=u.wheelDeltaX/120*this.options.mouseWheelSpeed;r=u.wheelDeltaY/120*this.options.mouseWheelSpeed}else{if("wheelDelta" in u){s=r=u.wheelDelta/120*this.options.mouseWheelSpeed}else{if("detail" in u){s=r=-u.detail/3*this.options.mouseWheelSpeed}else{return}}}}s*=this.options.invertWheelDirection;r*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){s=r;r=0}if(this.options.snap){v=this.currentPage.pageX;t=this.currentPage.pageY;if(s>0){v--}else{if(s<0){v++}}if(r>0){t--}else{if(r<0){t++}}this.goToPage(v,t);return}v=this.x+d.round(this.hasHorizontalScroll?s:0);t=this.y+d.round(this.hasVerticalScroll?r:0);if(v>0){v=0}else{if(v<this.maxScrollX){v=this.maxScrollX}}if(t>0){t=0}else{if(t<this.maxScrollY){t=this.maxScrollY}}this.scrollTo(v,t,0);if(this.options.probeType>1){this._execEvent("scroll")}},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=="string"){this.options.snap=this.scroller.querySelectorAll(this.options.snap)}this.on("refresh",function(){var w=0,u,s=0,r,v,t,A=0,z,C=this.options.snapStepX||this.wrapperWidth,B=this.options.snapStepY||this.wrapperHeight,q;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return}if(this.options.snap===true){v=d.round(C/2);t=d.round(B/2);while(A>-this.scrollerWidth){this.pages[w]=[];u=0;z=0;while(z>-this.scrollerHeight){this.pages[w][u]={x:d.max(A,this.maxScrollX),y:d.max(z,this.maxScrollY),width:C,height:B,cx:A-v,cy:z-t};z-=B;u++}A-=C;w++}}else{q=this.options.snap;u=q.length;r=-1;for(;w<u;w++){if(w===0||q[w].offsetLeft<=q[w-1].offsetLeft){s=0;r++}if(!this.pages[s]){this.pages[s]=[]}A=d.max(-q[w].offsetLeft,this.maxScrollX);z=d.max(-q[w].offsetTop,this.maxScrollY);v=A-d.round(q[w].offsetWidth/2);t=z-d.round(q[w].offsetHeight/2);this.pages[s][r]={x:A,y:z,width:q[w].offsetWidth,height:q[w].offsetHeight,cx:v,cy:t};if(A>this.maxScrollX){s++}}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold}else{this.snapThresholdX=d.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=d.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}});this.on("flick",function(){var q=this.options.snapSpeed||d.max(d.max(d.min(d.abs(this.x-this.startX),1000),d.min(d.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,q)})},_nearestSnap:function(r,u){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0}}var t=0,s=this.pages.length,q=0;if(d.abs(r-this.absStartX)<this.snapThresholdX&&d.abs(u-this.absStartY)<this.snapThresholdY){return this.currentPage}if(r>0){r=0}else{if(r<this.maxScrollX){r=this.maxScrollX}}if(u>0){u=0}else{if(u<this.maxScrollY){u=this.maxScrollY}}for(;t<s;t++){if(r>=this.pages[t][0].cx){r=this.pages[t][0].x;break}}s=this.pages[t].length;for(;q<s;q++){if(u>=this.pages[0][q].cy){u=this.pages[0][q].y;break}}if(t==this.currentPage.pageX){t+=this.directionX;if(t<0){t=0}else{if(t>=this.pages.length){t=this.pages.length-1}}r=this.pages[t][0].x}if(q==this.currentPage.pageY){q+=this.directionY;if(q<0){q=0}else{if(q>=this.pages[0].length){q=this.pages[0].length-1}}u=this.pages[0][q].y}return{x:r,y:u,pageX:t,pageY:q}},goToPage:function(q,v,r,u){u=u||this.options.bounceEasing;if(q>=this.pages.length){q=this.pages.length-1}else{if(q<0){q=0}}if(v>=this.pages[q].length){v=this.pages[q].length-1}else{if(v<0){v=0}}var t=this.pages[q][v].x,s=this.pages[q][v].y;r=r===undefined?this.options.snapSpeed||d.max(d.max(d.min(d.abs(t-this.x),1000),d.min(d.abs(s-this.y),1000)),300):r;this.currentPage={x:t,y:s,pageX:q,pageY:v};this.scrollTo(t,s,r,u)},next:function(r,t){var q=this.currentPage.pageX,s=this.currentPage.pageY;q++;if(q>=this.pages.length&&this.hasVerticalScroll){q=0;s++}this.goToPage(q,s,r,t)},prev:function(r,t){var q=this.currentPage.pageX,s=this.currentPage.pageY;q--;if(q<0&&this.hasVerticalScroll){q=0;s--}this.goToPage(q,s,r,t)},_initKeys:function(s){var r={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var q;if(typeof this.options.keyBindings=="object"){for(q in this.options.keyBindings){if(typeof this.options.keyBindings[q]=="string"){this.options.keyBindings[q]=this.options.keyBindings[q].toUpperCase().charCodeAt(0)}}}else{this.options.keyBindings={}}for(q in r){this.options.keyBindings[q]=this.options.keyBindings[q]||r[q]}m.addEvent(k,"keydown",this);this.on("destroy",function(){m.removeEvent(k,"keydown",this)})},_key:function(v){if(!this.enabled){return}var q=this.options.snap,w=q?this.currentPage.pageX:this.x,u=q?this.currentPage.pageY:this.y,s=m.getTime(),r=this.keyTime||0,t=0.25,x;if(this.options.useTransition&&this.isInTransition){x=this.getComputedPosition();this._translate(d.round(x.x),d.round(x.y));this.isInTransition=false}this.keyAcceleration=s-r<200?d.min(this.keyAcceleration+t,50):0;switch(v.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){w+=q?1:this.wrapperWidth}else{u+=q?1:this.wrapperHeight}break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){w-=q?1:this.wrapperWidth}else{u-=q?1:this.wrapperHeight}break;case this.options.keyBindings.end:w=q?this.pages.length-1:this.maxScrollX;u=q?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:w=0;u=0;break;case this.options.keyBindings.left:w+=q?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:u+=q?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:w-=q?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:u-=q?1:5+this.keyAcceleration>>0;break;default:return}if(q){this.goToPage(w,u);return}if(w>0){w=0;this.keyAcceleration=0}else{if(w<this.maxScrollX){w=this.maxScrollX;this.keyAcceleration=0}}if(u>0){u=0;this.keyAcceleration=0}else{if(u<this.maxScrollY){u=this.maxScrollY;this.keyAcceleration=0}}this.scrollTo(w,u,0);this.keyTime=s},_animate:function(z,y,t,q){var w=this,v=this.x,u=this.y,r=m.getTime(),x=r+t;function s(){var A=m.getTime(),C,B,D;if(A>=x){w.isAnimating=false;w._translate(z,y);if(!w.resetPosition(w.options.bounceTime)){w._execEvent("scrollEnd")}return}A=(A-r)/t;D=q(A);C=(z-v)*D+v;B=(y-u)*D+u;w._translate(C,B);if(w.isAnimating){c(s)}}if(w.options.probeType==3){w._execEvent("scroll")}this.isAnimating=true;s()},handleEvent:function(q){switch(q.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(q);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(q);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(q);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(q);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(q);break;case"keydown":this._key(q);break;case"click":if(!q._constructed){q.preventDefault();q.stopPropagation()}break}}};function e(t,r,s){var u=l.createElement("div"),q=l.createElement("div");if(s===true){u.style.cssText="position:absolute;z-index:9999";q.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border-radius:2px"}q.className="iScrollIndicator";if(t=="h"){if(s===true){u.style.cssText+=";height:2px;left:2px;right:2px;bottom:0";q.style.height="100%"}u.className="iScrollHorizontalScrollbar"}else{if(s===true){u.style.cssText+=";width:2px;bottom:2px;top:2px;right:1px";q.style.width="100%"}u.className="iScrollVerticalScrollbar"}u.style.cssText+=";overflow:hidden";if(!r){u.style.pointerEvents="none"}u.appendChild(q);return u}function p(q,r){this.wrapper=typeof r.el=="string"?l.querySelector(r.el):r.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=q;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0,topOffset:q.options.topOffset?q.options.topOffset:0,bottomOffset:q.options.bottomOffset?q.options.bottomOffset:0};for(var s in r){this.options[s]=r[s]}this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){m.addEvent(this.indicator,"touchstart",this);m.addEvent(k,"touchend",this)}if(!this.options.disablePointer){m.addEvent(this.indicator,m.prefixPointerEvent("pointerdown"),this);m.addEvent(k,m.prefixPointerEvent("pointerup"),this)}if(!this.options.disableMouse){m.addEvent(this.indicator,"mousedown",this);m.addEvent(k,"mouseup",this)}}if(this.options.fade){this.wrapperStyle[m.style.transform]=this.scroller.translateZ;this.wrapperStyle[m.style.transitionDuration]=m.isBadAndroid?"0.001s":"0ms";this.wrapperStyle.opacity="0"}}p.prototype={handleEvent:function(q){switch(q.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(q);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(q);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(q);break}},destroy:function(){if(this.options.interactive){m.removeEvent(this.indicator,"touchstart",this);m.removeEvent(this.indicator,m.prefixPointerEvent("pointerdown"),this);m.removeEvent(this.indicator,"mousedown",this);m.removeEvent(k,"touchmove",this);m.removeEvent(k,m.prefixPointerEvent("pointermove"),this);m.removeEvent(k,"mousemove",this);m.removeEvent(k,"touchend",this);m.removeEvent(k,m.prefixPointerEvent("pointerup"),this);m.removeEvent(k,"mouseup",this)}if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper)}},_start:function(r){var q=r.touches?r.touches[0]:r;r.preventDefault();r.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=q.pageX;this.lastPointY=q.pageY;this.startTime=m.getTime();if(!this.options.disableTouch){m.addEvent(k,"touchmove",this)}if(!this.options.disablePointer){m.addEvent(k,m.prefixPointerEvent("pointermove"),this)}if(!this.options.disableMouse){m.addEvent(k,"mousemove",this)}this.scroller._execEvent("beforeScrollStart")},_move:function(v){var r=v.touches?v.touches[0]:v,s,q,w,u,t=m.getTime();if(!this.moved){this.scroller._execEvent("scrollStart")}this.moved=true;s=r.pageX-this.lastPointX;this.lastPointX=r.pageX;q=r.pageY-this.lastPointY;this.lastPointY=r.pageY;w=this.x+s;u=this.y+q;this._pos(w,u);if(this.scroller.options.probeType==1&&t-this.startTime>300){this.startTime=t;this.scroller._execEvent("scroll")}else{if(this.scroller.options.probeType>1){this.scroller._execEvent("scroll")}}v.preventDefault();v.stopPropagation()},_end:function(s){if(!this.initiated){return}this.initiated=false;s.preventDefault();s.stopPropagation();m.removeEvent(k,"touchmove",this);m.removeEvent(k,m.prefixPointerEvent("pointermove"),this);m.removeEvent(k,"mousemove",this);if(this.scroller.options.snap){var q=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var r=this.options.snapSpeed||d.max(d.max(d.min(d.abs(this.scroller.x-q.x),1000),d.min(d.abs(this.scroller.y-q.y),1000)),300);if(this.scroller.x!=q.x||this.scroller.y!=q.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=q;this.scroller.scrollTo(q.x,q.y,r,this.scroller.options.bounceEasing)}}if(this.moved){this.scroller._execEvent("scrollEnd")}},transitionTime:function(q){q=q||0;this.indicatorStyle[m.style.transitionDuration]=q+"ms";if(!q&&m.isBadAndroid){this.indicatorStyle[m.style.transitionDuration]="0.001s"}},transitionTimingFunction:function(q){this.indicatorStyle[m.style.transitionTimingFunction]=q},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none"}else{if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none"}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none"}}if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){m.addClass(this.wrapper,"iScrollBothScrollbars");m.removeClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="8px"}else{this.wrapper.style.bottom="8px"}}}else{m.removeClass(this.wrapper,"iScrollBothScrollbars");m.addClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="2px"}else{this.wrapper.style.bottom="2px"}}}var s=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=d.max(d.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+"px"}else{this.indicatorWidth=this.indicator.clientWidth}this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=="clip"){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX}this.sizeRatioX=this.options.speedRatioX||(this.scroller.maxScrollX&&(this.maxPosX/this.scroller.maxScrollX))}var t,q;if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.topOffset){t=this.options.topOffset}else{t=0}if(this.options.bottomOffset){q=this.options.bottomOffset}else{q=0}if(this.options.resize){this.indicatorHeight=d.max(d.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1))-(q+t),8);this.indicatorStyle.height=this.indicatorHeight+"px"}else{this.indicatorHeight=this.indicator.clientHeight}this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=="clip"){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8}else{this.minBoundaryY=t?t:0;this.maxBoundaryY=this.maxPosY}this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||(this.scroller.maxScrollY&&(this.maxPosY/this.scroller.maxScrollY))}this.updatePosition()},updatePosition:function(){var q=this.options.listenX&&d.round(this.sizeRatioX*this.scroller.x)||0,r=this.options.listenY&&d.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(q<this.minBoundaryX){if(this.options.shrink=="scale"){this.width=d.max(this.indicatorWidth+q,8);this.indicatorStyle.width=this.width+"px"}q=this.minBoundaryX}else{if(q>this.maxBoundaryX){if(this.options.shrink=="scale"){this.width=d.max(this.indicatorWidth-(q-this.maxPosX),8);this.indicatorStyle.width=this.width+"px";q=this.maxPosX+this.indicatorWidth-this.width}else{q=this.maxBoundaryX}}else{if(this.options.shrink=="scale"&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+"px"}}}if(r<this.minBoundaryY){if(this.options.shrink=="scale"){this.height=d.max(this.indicatorHeight+r*3,8);this.indicatorStyle.height=this.height+"px"}r=this.options.topOffset?this.options.topOffset:this.minBoundaryY}else{if(r>this.maxBoundaryY){if(this.options.shrink=="scale"){this.height=d.max(this.indicatorHeight-(r-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+"px";r=this.maxPosY+this.indicatorHeight-this.height}else{r=this.maxBoundaryY}}else{if(this.options.shrink=="scale"&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+"px"}}}}this.x=q;this.y=r;if(this.scroller.options.useTransform){this.indicatorStyle[m.style.transform]="translate("+q+"px,"+r+"px)"+this.scroller.translateZ}else{this.indicatorStyle.left=q+"px";this.indicatorStyle.top=r+"px"}},_pos:function(q,r){if(q<0){q=0}else{if(q>this.maxPosX){q=this.maxPosX}}if(r<0){r=0}else{if(r>this.maxPosY){r=this.maxPosY}}q=this.options.listenX?d.round(q/this.sizeRatioX):this.scroller.x;r=this.options.listenY?d.round(r/this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(q,r)},fade:function(t,s){if(s&&!this.visible){return}clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var r=t?250:500,q=t?0:300;t=t?"1":"0";this.wrapperStyle[m.style.transitionDuration]=r+"ms";this.fadeTimeout=setTimeout((function(u){this.wrapperStyle.opacity=u;this.visible=+u}).bind(this,t),q)}};j.utils=m;if(typeof module!="undefined"&&module.exports){module.exports=j}else{k.IScroll=j}f.iScrollUtils=m;f.iScroll=function(r,q){return new j(f.isIns(r)?r[i]:r,q)}})($$$,window,document,Math);(function(c){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(f){window.setTimeout(f,1000/60)};var b=(function(){var k={};var l=document.createElement("div").style;var h=(function(){var p=["t","webkitT","MozT","msT","OT"],n,o=0,m=p.length;for(;o<m;o++){n=p[o]+"ransform";if(n in l){return p[o].substr(0,p[o].length-1)}}return false})();function j(m){if(h===false){return false}if(h===""){return m}return h+m.charAt(0).toUpperCase()+m.substr(1)}k.getTime=Date.now||function f(){return new Date().getTime()};k.extend=function(o,n){for(var m in n){o[m]=n[m]}};k.addEvent=function(p,o,n,m){p.addEventListener(o,n,!!m)};k.removeEvent=function(p,o,n,m){p.removeEventListener(o,n,!!m)};k.prefixPointerEvent=function(m){return window.MSPointerEvent?"MSPointer"+m.charAt(9).toUpperCase()+m.substr(10):m};k.momentum=function(s,o,p,m,t,u){var n=s-o,q=Math.abs(n)/p,v,r;u=u===undefined?0.0006:u;v=s+(q*q)/(2*u)*(n<0?-1:1);r=q/u;if(v<m){v=t?m-(t/2.5*(q/8)):m;n=Math.abs(v-s);r=n/q}else{if(v>0){v=t?t/2.5*(q/8):0;n=Math.abs(s)+v;r=n/q}}return{destination:Math.round(v),duration:r}};var g=j("transform");k.extend(k,{hasTransform:g!==false,hasPerspective:j("perspective") in l,hasTouch:"ontouchstart" in window,hasPointer:window.PointerEvent||window.MSPointerEvent,hasTransition:j("transition") in l});k.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!(/Chrome\/\d/.test(window.navigator.appVersion));k.extend(k.style={},{transform:g,transitionTimingFunction:j("transitionTimingFunction"),transitionDuration:j("transitionDuration"),transitionDelay:j("transitionDelay"),transformOrigin:j("transformOrigin"),transitionProperty:j("transitionProperty")});k.offset=function(m){var o=-m.offsetLeft,n=-m.offsetTop;while(m=m.offsetParent){o-=m.offsetLeft;n-=m.offsetTop}return{left:o,top:n}};k.preventDefaultException=function(o,n){for(var m in n){if(n[m].test(o[m])){return true}}return false};k.extend(k.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});k.extend(k.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(m){return m*(2-m)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(m){return Math.sqrt(1-(--m*m))}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(n){var m=4;return(n=n-1)*n*((m+1)*n+m)+1}},bounce:{style:"",fn:function(m){if((m/=1)<(1/2.75)){return 7.5625*m*m}else{if(m<(2/2.75)){return 7.5625*(m-=(1.5/2.75))*m+0.75}else{if(m<(2.5/2.75)){return 7.5625*(m-=(2.25/2.75))*m+0.9375}else{return 7.5625*(m-=(2.625/2.75))*m+0.984375}}}}},elastic:{style:"",fn:function(m){var n=0.22,o=0.4;if(m===0){return 0}if(m==1){return 1}return(o*Math.pow(2,-10*m)*Math.sin((m-n/4)*(2*Math.PI)/n)+1)}}});k.tap=function(o,m){var n=document.createEvent("Event");n.initEvent(m,true,true);n.pageX=o.pageX;n.pageY=o.pageY;o.target.dispatchEvent(n)};k.click=function(o){var n=o.target,m;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(n.tagName)){m=document.createEvent("MouseEvents");m.initMouseEvent("click",true,true,o.view,1,n.screenX,n.screenY,n.clientX,n.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,0,null);m._constructed=true;n.dispatchEvent(m)}};return k})();function d(k,g){this.wrapper=typeof k=="string"?c(k)[0]:k;this.options={startX:0,startY:0,scrollY:true,scrollX:false,directionLockThreshold:5,momentum:true,duration:300,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,eventPassthrough:true,freeScroll:false,bindToWrapper:true,resizePolling:60,disableMouse:false,disableTouch:false,disablePointer:false,tap:true,click:false,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var j in g){this.options[j]=g[j]}if(!this.options.role&&this.options.scrollX===false){this.options.eventPassthrough="horizontal"}if(this.options.role==="slider"){this.options.scrollX=true;this.options.scrollY=false;this.options.momentum=false;this.scroller=c(".ui-slider-content")[0];c(this.scroller.children[0]).addClass("current");this.currentPage=0;this.count=this.scroller.children.length;this.scroller.style.width=this.count+"00%";this.itemWidth=this.scroller.children[0].clientWidth;this.scrollWidth=this.itemWidth*this.count;if(this.options.indicator){var f='<ul class="ui-slider-indicators">';for(var j=1;j<=this.count;j++){if(j===1){f+='<li class="current">'+j+"</li>"}else{f+="<li>"+j+"</li>"}}f+="</ul>";c(this.wrapper).append(f);this.indicator=c(".ui-slider-indicators")[0]}}else{if(this.options.role==="tab"){this.options.scrollX=true;this.options.scrollY=false;this.options.momentum=false;this.scroller=c(".ui-tab-content")[0];this.nav=c(".ui-tab-nav")[0];c(this.scroller.children[0]).addClass("current");c(this.nav.children[0]).addClass("current");this.currentPage=0;this.count=this.scroller.children.length;this.scroller.style.width=this.count+"00%";this.itemWidth=this.scroller.children[0].clientWidth;this.scrollWidth=this.itemWidth*this.count}else{this.scroller=this.wrapper.children[0]}}this.scrollerStyle=this.scroller.style;this.translateZ=b.hasPerspective&&this.options.HWCompositing?" translateZ(0)":"";this.options.useTransition=b.hasTransition&&this.options.useTransition;this.options.useTransform=b.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?b.ease[this.options.bounceEasing]||b.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}if(this.options.useTransform===false){this.scroller.style.position="relative"}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable();if(this.options.autoplay){var h=this;this.options.interval=this.options.interval||2000;this.options.flag=setTimeout(function(){h._autoplay.apply(h)},h.options.interval)}}d.prototype={_init:function(){this._initEvents()},_initEvents:function(f){var g=f?b.removeEvent:b.addEvent,h=this.options.bindToWrapper?this.wrapper:window;g(window,"orientationchange",this);g(window,"resize",this);if(this.options.click){g(this.wrapper,"click",this,true)}if(!this.options.disableMouse){g(this.wrapper,"mousedown",this);g(h,"mousemove",this);g(h,"mousecancel",this);g(h,"mouseup",this)}if(b.hasPointer&&!this.options.disablePointer){g(this.wrapper,b.prefixPointerEvent("pointerdown"),this);g(h,b.prefixPointerEvent("pointermove"),this);g(h,b.prefixPointerEvent("pointercancel"),this);g(h,b.prefixPointerEvent("pointerup"),this)}if(b.hasTouch&&!this.options.disableTouch){g(this.wrapper,"touchstart",this);g(h,"touchmove",this);g(h,"touchcancel",this);g(h,"touchend",this)}g(this.scroller,"transitionend",this);g(this.scroller,"webkitTransitionEnd",this);g(this.scroller,"oTransitionEnd",this);g(this.scroller,"MSTransitionEnd",this);if(this.options.role==="tab"){g(this.nav,"touchend",this);g(this.nav,"mouseup",this);g(this.nav,"pointerup",this)}},refresh:function(){var n=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;var l=window.getComputedStyle(this.wrapper,null);var p=l["padding-top"].replace(/[^-\d.]/g,""),k=l["padding-bottom"].replace(/[^-\d.]/g,""),h=l["padding-left"].replace(/[^-\d.]/g,""),f=l["padding-right"].replace(/[^-\d.]/g,"");var q=window.getComputedStyle(this.scroller,null);var g=q["margin-top"].replace(/[^-\d.]/g,""),j=q["margin-bottom"].replace(/[^-\d.]/g,""),o=q["margin-left"].replace(/[^-\d.]/g,""),m=q["margin-right"].replace(/[^-\d.]/g,"");this.scrollerWidth=this.scroller.offsetWidth+parseInt(h)+parseInt(f)+parseInt(o)+parseInt(m);this.scrollerHeight=this.scroller.offsetHeight+parseInt(p)+parseInt(k)+parseInt(g)+parseInt(j);if(this.options.role==="slider"||this.options.role==="tab"){this.scrollerWidth=this.scrollWidth}this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=b.offset(this.wrapper);this.resetPosition()},handleEvent:function(f){switch(f.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(f);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(f);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(f);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(f);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(f);break;case"keydown":this._key(f);break;case"click":if(!f._constructed){f.preventDefault();f.stopPropagation()}break}},_start:function(h){if(b.eventType[h.type]!=1){if(h.button!==0){return}}if(!this.enabled||(this.initiated&&b.eventType[h.type]!==this.initiated)){return}if(this.options.preventDefault&&!b.isBadAndroid&&!b.preventDefaultException(h.target,this.options.preventDefaultException)){h.preventDefault()}var f=h.touches?h.touches[0]:h,j;this.initiated=b.eventType[h.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=b.getTime();if(this.options.useTransition&&this.isInTransition&&this.options.role!=="slider"&&this.options.role!=="tab"){this.isInTransition=false;j=this.getComputedPosition();this._translate(Math.round(j.x),Math.round(j.y))}else{if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false}}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=f.pageX;this.pointY=f.pageY;if(this.options.autoplay){var g=this;clearTimeout(this.options.flag);this.options.flag=setTimeout(function(){g._autoplay.apply(g)},g.options.interval)}event.stopPropagation()},_move:function(l){if(!this.enabled||b.eventType[l.type]!==this.initiated){return}if(this.options.preventDefault){l.preventDefault()}var n=l.touches?l.touches[0]:l,h=n.pageX-this.pointX,g=n.pageY-this.pointY,m=b.getTime(),f,o,k,j;this.pointX=n.pageX;this.pointY=n.pageY;this.distX+=h;this.distY+=g;k=Math.abs(this.distX);j=Math.abs(this.distY);if(m-this.endTime>300&&(k<10&&j<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(k>j+this.options.directionLockThreshold){this.directionLocked="h"}else{if(j>=k+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}}if(this.directionLocked=="h"){if(this.options.role==="tab"){c(this.scroller).children("li").height("auto")}if(this.options.eventPassthrough=="vertical"){l.preventDefault()}else{if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}}g=0}else{if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){l.preventDefault()}else{if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}}h=0}}h=this.hasHorizontalScroll?h:0;g=this.hasVerticalScroll?g:0;f=this.x+h;o=this.y+g;if(f>0||f<this.maxScrollX){f=this.options.bounce?this.x+h/3:f>0?0:this.maxScrollX}if(o>0||o<this.maxScrollY){o=this.options.bounce?this.y+g/3:o>0?0:this.maxScrollY}this.directionX=h>0?-1:h<0?1:0;this.directionY=g>0?-1:g<0?1:0;this.moved=true;this._translate(f,o);if(m-this.startTime>300){this.startTime=m;this.startX=this.x;this.startY=this.y}},_end:function(m){if(!this.enabled||b.eventType[m.type]!==this.initiated){return}if(this.options.preventDefault&&!b.preventDefaultException(m.target,this.options.preventDefaultException)){m.preventDefault()}var o=m.changedTouches?m.changedTouches[0]:m,h,g,k=b.getTime()-this.startTime,f=Math.round(this.x),r=Math.round(this.y),q=Math.abs(f-this.startX),p=Math.abs(r-this.startY),j=0,n="";this.isInTransition=0;this.initiated=0;this.endTime=b.getTime();if(this.resetPosition(this.options.bounceTime)){if(this.options.role==="tab"){c(this.scroller.children[this.currentPage]).siblings("li").height(0)}return}this.scrollTo(f,r);if(!this.moved){if(this.options.tap&&b.eventType[m.type]===1){b.tap(m,this.options.tap)}if(this.options.click){b.click(m)}}if(this.options.momentum&&k<300){h=this.hasHorizontalScroll?b.momentum(this.x,this.startX,k,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:f,duration:0};g=this.hasVerticalScroll?b.momentum(this.y,this.startY,k,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:r,duration:0};f=h.destination;r=g.destination;j=Math.max(h.duration,g.duration);this.isInTransition=1}if(f!=this.x||r!=this.y){if(f>0||f<this.maxScrollX||r>0||r<this.maxScrollY){n=b.ease.quadratic}this.scrollTo(f,r,j,n);return}if(this.options.role==="tab"&&c(event.target).closest("ul").hasClass("ui-tab-nav")){c(this.nav).children().removeClass("current");c(event.target).addClass("current");var l=this.currentPage;this.currentPage=c(event.target).index();c(this.scroller).children().height("auto");this._execEvent("beforeScrollStart",l,this.currentPage)}if(this.options.role==="slider"||this.options.role==="tab"){if(q<30){this.scrollTo(-this.itemWidth*this.currentPage,0,this.options.bounceTime,this.options.bounceEasing)}else{if(f-this.startX<0){this._execEvent("beforeScrollStart",this.currentPage,this.currentPage+1);this.scrollTo(-this.itemWidth*++this.currentPage,0,this.options.bounceTime,this.options.bounceEasing)}else{if(f-this.startX>=0){this._execEvent("beforeScrollStart",this.currentPage,this.currentPage-1);this.scrollTo(-this.itemWidth*--this.currentPage,0,this.options.bounceTime,this.options.bounceEasing)}}}if(this.options.role==="tab"){c(this.scroller.children[this.currentPage]).siblings("li").height(0)}if(this.indicator&&q>=30){c(this.indicator).children().removeClass("current");c(this.indicator.children[this.currentPage]).addClass("current")}else{if(this.nav&&q>=30){c(this.nav).children().removeClass("current");c(this.nav.children[this.currentPage]).addClass("current")}}c(this.scroller).children().removeClass("current");c(this.scroller.children[this.currentPage]).addClass("current")}},_resize:function(){var f=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){f.refresh()},this.options.resizePolling)},_transitionEnd:function(f){if(f.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd",this.currentPage)}},destroy:function(){this._initEvents(true)},resetPosition:function(g){var f=this.x,h=this.y;g=g||0;if(!this.hasHorizontalScroll||this.x>0){f=0}else{if(this.x<this.maxScrollX){f=this.maxScrollX}}if(!this.hasVerticalScroll||this.y>0){h=0}else{if(this.y<this.maxScrollY){h=this.maxScrollY}}if(f==this.x&&h==this.y){return false}this.scrollTo(f,h,g,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},on:function(g,f){if(!this._events[g]){this._events[g]=[]}this._events[g].push(f)},off:function(h,g){if(!this._events[h]){return}var f=this._events[h].indexOf(g);if(f>-1){this._events[h].splice(f,1)}},_execEvent:function(h){if(!this._events[h]){return}var g=0,f=this._events[h].length;if(!f){return}for(;g<f;g++){this._events[h][g].apply(this,[].slice.call(arguments,1))}},scrollTo:function(f,j,g,h){h=h||b.ease.circular;this.isInTransition=this.options.useTransition&&g>0;if(!g||(this.options.useTransition&&h.style)){if(this.options.role==="slider"||this.options.role==="tab"){g=this.options.duration;this.scrollerStyle[b.style.transitionProperty]=b.style.transform}this.scrollerStyle[b.style.transitionTimingFunction]=h.style;this._transitionTime(g);this._translate(f,j)}else{this._animate(f,j,g,h.fn)}},scrollToElement:function(g,h,f,l,k){g=g.nodeType?g:this.scroller.querySelector(g);if(!g){return}var j=b.offset(g);j.left-=this.wrapperOffset.left;j.top-=this.wrapperOffset.top;if(f===true){f=Math.round(g.offsetWidth/2-this.wrapper.offsetWidth/2)}if(l===true){l=Math.round(g.offsetHeight/2-this.wrapper.offsetHeight/2)}j.left-=f||0;j.top-=l||0;j.left=j.left>0?0:j.left<this.maxScrollX?this.maxScrollX:j.left;j.top=j.top>0?0:j.top<this.maxScrollY?this.maxScrollY:j.top;h=h===undefined||h===null||h==="auto"?Math.max(Math.abs(this.x-j.left),Math.abs(this.y-j.top)):h;this.scrollTo(j.left,j.top,h,k)},_transitionTime:function(f){f=f||0;this.scrollerStyle[b.style.transitionDuration]=f+"ms";if(!f&&b.isBadAndroid){this.scrollerStyle[b.style.transitionDuration]="0.001s"}},_translate:function(f,g){if(this.options.useTransform){this.scrollerStyle[b.style.transform]="translate("+f+"px,"+g+"px)"+this.translateZ}else{f=Math.round(f);g=Math.round(g);this.scrollerStyle.left=f+"px";this.scrollerStyle.top=g+"px"}this.x=f;this.y=g},getComputedPosition:function(){var g=window.getComputedStyle(this.scroller,null),f,h;if(this.options.useTransform){g=g[b.style.transform].split(")")[0].split(", ");f=+(g[12]||g[4]);h=+(g[13]||g[5])}else{f=+g.left.replace(/[^-\d.]/g,"");h=+g.top.replace(/[^-\d.]/g,"")}return{x:f,y:h}},_animate:function(p,o,j,f){var m=this,l=this.x,k=this.y,g=b.getTime(),n=g+j;function h(){var q=b.getTime(),s,r,t;if(q>=n){m.isAnimating=false;m._translate(p,o);if(!m.resetPosition(m.options.bounceTime)){m._execEvent("scrollEnd",this.currentPage)}return}q=(q-g)/j;t=f(q);s=(p-l)*t+l;r=(o-k)*t+k;m._translate(s,r);if(m.isAnimating){e(h)}}this.isAnimating=true;h()},_autoplay:function(){var f=this,g=f.currentPage;f.currentPage=f.currentPage>=f.count-1?0:++f.currentPage;f._execEvent("beforeScrollStart",g,f.currentPage);if(this.options.role==="tab"){c(this.scroller).children().height("auto");document.body.scrollTop=0}f.scrollTo(-f.itemWidth*f.currentPage,0,f.options.bounceTime,f.options.bounceEasing);if(f.indicator){c(f.indicator).children().removeClass("current");c(f.indicator.children[f.currentPage]).addClass("current");c(f.scroller).children().removeClass("current");c(f.scroller.children[f.currentPage]).addClass("current")}else{if(f.nav){c(f.nav).children().removeClass("current");c(f.nav.children[f.currentPage]).addClass("current");c(f.scroller).children().removeClass("current");c(f.scroller.children[f.currentPage]).addClass("current")}}f.options.flag=setTimeout(function(){f._autoplay.apply(f)},f.options.interval)}};c.testiScroll=function(g,f){return new d(c.isIns(g)?g[i]:g,f)}})($$$);(function(d,c,f){var e=document,b=e.documentElement.style;d.cssPrefix=(function(){var g=["webkit","Moz","ms","O"];return{hasTouch:"ontouchstart" in c,cssTransformStart:!d.os.opera?"3d(":"(",cssTransformEnd:!d.os.opera?",0)":", )",prefix:(function(){var k;for(var h=0;h<g.length;h++){if(b[g[h]+"Transform"]===""){k=g[h]}}return k})()}})();d.getCssMatrix=function(l){if(d.isIns(l)){l=l.get(0)}var k=c.WebKitCSSMatrix||c.MSCSSMatrix;if(l===f){if(k){return new k()}else{return{a:0,b:0,c:0,d:0,e:0,f:0}}}var g=c.getComputedStyle(l);var h=g.webkitTransform||g.transform||g[d.cssPrefix.prefix+"Transform"];if(k){return new k(h)}else{if(h){var j=h.replace(/[^0-9\-.,]/g,"").split(",");return{a:+j[0],b:+j[1],c:+j[2],d:+j[3],e:+j[4],f:+j[5]}}else{return{a:0,b:0,c:0,d:0,e:0,f:0}}}};d.transEnd_EV=(function(){if(d.isEmptyObject(d.cssPrefix)){return false}var g={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return g[d.cssPrefix.prefix]})();d.animateEnd_EV=(function(){if(d.isEmptyObject(d.cssPrefix)){return false}var g={"":"animationEnd",webkit:"webkitAnimationEnd",Moz:"animationend",O:"oanimationend",ms:"animationend"};return g[d.cssPrefix.prefix]})();d.touch_EV=(function(){return{resize_EV:"onorientationchange" in c?"orientationchange":"resize",start_EV:d.cssPrefix.hasTouch?"touchstart":"mousedown",move_EV:d.cssPrefix.hasTouch?"touchmove":"mousemove",end_EV:d.cssPrefix.hasTouch?"touchend":"mouseup",cancel_EV:d.cssPrefix.hasTouch?"touchcancel":"mouseup"}})()})($$$,window);(function(c){var d=/[^, ]+/g;function b(j,g){var h=document.createEvent("Events"),e=true;if(g){for(var f in g){if(f==="bubbles"){e=!!g[f]}else{h[f]=g[f]}}}h.initEvent(j,e,true,null,null,null,null,null,null,null,null,null,null,null,null);return h}c.on=function(h,n,o,q){if(!h){return}if((h.nodeType&&(h.nodeType===1||h.nodeType==9))||c.isWindow(h)){n=n.match(d);var e=c.cache.getGid(h),l=0,g=0,f=0,m=n.length;var p=c.cache.eventCache[e]=c.cache.eventCache[e]?c.cache.eventCache[e]:{};for(;l<m;l++){if(!p[n[l]]){p[n[l]]=[];p[n[l]].push(o);h.addEventListener(n[l],o,!!q)}else{if(c.isArray(p[n[l]])&&!(c.inArray(p[n[l]],o))){p[n[l]].push(o);h.addEventListener(n[l],o,!!q)}}}}};c.one=function(j,h,g,e){if(!j){return}var f=function(){g.apply(j,arguments);c.off(j,h,f,e)};c.on(j,h,f,e)};c.off=function(h,l,m,n){if(!h){return}if((h.nodeType&&(h.nodeType===1||h.nodeType==9))||c.isWindow(h)){var f=c.cache.getGid(h);var e=arguments.length;var o=c.cache.eventCache[f];var k=function(u,v){var r=u?o[u]:false;var q=v===undefined?m:false;var p=0;if(r){p=r.length;if(q){for(var t=0;t<p;t++){if(r[t]==q){h.removeEventListener(u,m,!!n);r.splice(t,1)}}}else{if(q===false){for(var t=0;t<p;t++){h.removeEventListener(u,r[t],!!n);r.splice(t,1)}}}}else{for(var t in o){var r=o[t],p=r.length;for(var s=0;s<p;s++){h.removeEventListener(t,r[s],!!n);r.splice(s,1)}}}};if(!o||c.isFunction(l)){return}l=l?l.match(d):[];if(e>=3){for(var g=0,j=l.length;g<j;g++){k(l[g])}}else{if(e==2){for(var g=0,j=l.length;g<j;g++){k(l[g],false)}}else{k()}}}};c.trigger=function(m,k,l){if(!m||!k){return}var n,h=0,g,f;if(typeof k!=="string"&&c.isObject(k)){for(g in k){n=" "+k[g]}}else{n=k}n=n.match(d);for(var e=n.length;h<e;h++){f=b(n[h]);if(l){f.data=l}m.dispatchEvent(f)}return m};c.each(["on","one","off"],function(f,e){c.fn[e]=function(k,j){var g=this.length;if(!g){return this}for(var h=0;h<g;h++){c[e](this[h],k,j)}return this}});c.fn.trigger=function(g,h){var e=this.length;if(!e||!g){return this}for(var f=0;f<e;f++){c.trigger(this[f],g,h)}return this}})($$$);(function(h){var j={},e;function b(k){return"tagName" in k?k:k.parentNode}function d(l,k,n,m){var p=Math.abs(l-k),o=Math.abs(n-m);if(p>=o){return(l-k>0?"Left":"Right")}else{return(n-m>0?"Up":"Down")}}var g=750;function f(){if(j.last&&(Date.now()-j.last>=g)){j.el.trigger("longTap");j={}}}var c;h(document).ready(function(){var k;h(document.body).on("touchstart",function(m){if(m.originalEvent){m=m.originalEvent}if(!m.touches||m.touches.length===0){return}var l=Date.now(),n=l-(j.last||l);if(!m.touches||m.touches.length===0){return}j.el=h(b(m.touches[0].target));e&&clearTimeout(e);j.x1=m.touches[0].pageX;j.y1=m.touches[0].pageY;j.x2=j.y2=0;if(n>0&&n<=250){j.isDoubleTap=true}j.last=l;c=setTimeout(f,g);if(!j.el.attr("data-pressed")){j.el.addClass("pressed")}if(k&&!k.attr("data-pressed")&&k[0]!==j.el[0]){k.removeClass("pressed")}k=j.el}).on("touchmove",function(l){if(l.originalEvent){l=l.originalEvent}j.x2=l.touches[0].pageX;j.y2=l.touches[0].pageY;clearTimeout(c)}).on("touchend",function(l){if(l.originalEvent){l=l.originalEvent}if(!j.el){return}if(!j.el.attr("data-pressed")){j.el.removeClass("pressed")}if(j.isDoubleTap){j.el.trigger("doubleTap");j={}}else{if(j.x2>0||j.y2>0){(Math.abs(j.x1-j.x2)>30||Math.abs(j.y1-j.y2)>30)&&j.el.trigger("swipe")&&j.el.trigger("swipe"+(d(j.x1,j.x2,j.y1,j.y2)));j.x1=j.x2=j.y1=j.y2=j.last=0}else{if("last" in j){j.el.trigger("tap");e=setTimeout(function(){e=null;if(j.el){j.el.trigger("singleTap")}j={}},250)}}}}).on("touchcancel",function(){if(j.el&&!j.el.attr("data-pressed")){j.el.removeClass("pressed")}j={};clearTimeout(c)})});h.each(["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"],function(l,k){h.fn[k]=function(m){return this.on(k,m)}})})($$$);(function(l){var b=[];var c=[];var k=[];var h=[];var e=function(s,r,q){if(!l.isFunction(s)){throw"$.asap - argument is not a valid function"}c.push(s);k.push(r?r:{});h.push(q?q:[]);window.postMessage(l.fn.namespace+"-asap","*")};window.addEventListener("message",function(q){if(q.source===window&&q.data===l.fn.namespace+"-asap"){q.stopPropagation();if(c.length>0){(c.shift()).apply(k.shift(),h.shift())}}},true);var d=function(q){if(!q.css3AnimateId){q.css3AnimateId=l.uuid()}return q.css3AnimateId};var g=function(q){if(typeof q==="string"||q instanceof String){return document.getElementById(q)}else{if(l.isIns(q)){return q[0]}else{return q}}};var n=function n(q){if(q===undefined||q===""){return 0}if(isNaN(parseFloat(q))){if(q.replace){q=q.replace(/[^0-9.-]/g,"")}else{return 0}}return parseFloat(q)};var p=function(t,q){var r,u,s=g(t);u=d(s);if(b[u]){b[u].animate(q);r=b[u]}else{r=m(s,q);b[u]=r}return r};l.fn.css3Animate=function(s){if(!s.complete&&s.callback){s.complete=s.callback}var r=p(this[0],s);s.complete=null;s.sucess=null;s.failure=null;for(var q=1;q<this.length;q++){r.link(this[q],s)}return r};var o=l.cssPrefix.cssTransformStart;var j=l.cssPrefix.cssTransformEnd;var f=l.transEnd_EV;var m=(function(){var q=function(r,s){if(!(this instanceof q)){return new q(r,s)}this.callbacksStack=[];this.activeEvent=null;this.countStack=0;this.isActive=false;this.el=r;this.linkFinishedProxy=l.proxy(this.linkFinished,this);if(!this.el){return}this.animate(s);var t=this;l(this.el).on("destroy",function(){var u=t.el.css3AnimateId;t.callbacksStack=[];if(b[u]){delete b[u]}})};q.prototype={animate:function(B){if(this.isActive){this.cancel()}this.isActive=true;if(!B){return}var s=!!B.addClass;var u,t;var z=n(B.time);if(z===0){B.time=0}if(!B.y){B.y=0}if(!B.x){B.x=0}if(B.previous){var w=new l.getCssMatrix(this.el);B.y+=n(w.f);B.x+=n(w.e)}if(!B.origin){B.origin="0% 0%"}if(!B.scale){B.scale="1"}if(!B.rotateY){B.rotateY="0"}if(!B.rotateX){B.rotateX="0"}if(!B.skewY){B.skewY="0"}if(!B.skewX){B.skewX="0"}if(!B.timingFunction){B.timingFunction="linear"}if(typeof(B.x)==="number"||(B.x.indexOf("%")===-1&&B.x.toLowerCase().indexOf("px")===-1&&B.x.toLowerCase().indexOf("deg")===-1)){B.x=parseInt(B.x,10)+"px"}if(typeof(B.y)==="number"||(B.y.indexOf("%")===-1&&B.y.toLowerCase().indexOf("px")===-1&&B.y.toLowerCase().indexOf("deg")===-1)){B.y=parseInt(B.y,10)+"px"}var A="translate"+o+(B.x)+","+(B.y)+j+" scale("+parseFloat(B.scale)+") rotate("+B.rotateX+")";if(!l.os.opera){A+=" rotateY("+B.rotateY+")"}A+=" skew("+B.skewX+","+B.skewY+")";this.el.style[l.cssPrefix.prefix+"Transform"]=A;this.el.style[l.cssPrefix.prefix+"BackfaceVisibility"]="hidden";var y=l.cssPrefix.prefix+"Transform";if(B.opacity!==undefined){this.el.style.opacity=B.opacity;y+=", opacity"}if(B.width){this.el.style.width=B.width;y="all"}if(B.height){this.el.style.height=B.height;y="all"}this.el.style[l.cssPrefix.prefix+"TransitionProperty"]="all";if((""+B.time).indexOf("s")===-1){u="ms";t=B.time+u}else{if(B.time.indexOf("ms")!==-1){u="ms";t=B.time}else{u="s";t=B.time+u}}if(B.delay){this.el.style[l.cssPrefix.prefix+"TransitionDelay"]=B.delay}this.el.style[l.cssPrefix.prefix+"TransitionDuration"]=t;this.el.style[l.cssPrefix.prefix+"TransitionTimingFunction"]=B.timingFunction;this.el.style[l.cssPrefix.prefix+"TransformOrigin"]=B.origin;this.callbacksStack.push({complete:B.complete,success:B.success,failure:B.failure});this.countStack++;var x=this,v;var r=window.getComputedStyle(this.el);if(z===0||(u==="ms"&&z<5)||r.display==="none"){e(l.proxy(this.finishAnimation,this,[false]))}else{this.activeEvent=function(C){clearTimeout(x.timeout);x.finishAnimation(C);x.el.removeEventListener(f,x.activeEvent,false)};x.timeout=setTimeout(this.activeEvent,n(B.time)+50);this.el.addEventListener(f,this.activeEvent,false)}},addCallbackHook:function(r){if(r){this.callbacksStack.push(r)}this.countStack++;return this.linkFinishedProxy},linkFinished:function(r){if(r){this.cancel()}else{this.finishAnimation()}},finishAnimation:function(r){if(r&&r.preventDefault){r.preventDefault()}if(!this.isActive){return}this.countStack--;if(this.countStack===0){this.fireCallbacks(false)}},fireCallbacks:function(r){this.clearEvents();var v=this.callbacksStack;this.cleanup();for(var u=0;u<v.length;u++){var s=v[u].complete;var w=v[u].success;var t=v[u].failure;if(typeof(s)==="function"){s(r)}if(r&&typeof(t)==="function"){t()}else{if(typeof(w)==="function"){w()}}}},cancel:function(){if(!this.isActive){return}this.fireCallbacks(true)},cleanup:function(){this.callbacksStack=[];this.isActive=false;this.countStack=0},clearEvents:function(){if(this.activeEvent){this.el.removeEventListener(f,this.activeEvent,false)}this.activeEvent=null},link:function(r,t){var s={complete:t.complete,success:t.success,failure:t.failure};t.complete=this.addCallbackHook(s);t.success=null;t.failure=null;p(r,t);t.complete=s.complete;t.success=s.success;t.failure=s.failure;return this}};return q})()})($$$);(function(c){c.classCss3Animate=function b(j,f,k){var l=c(j);if(!j.nodeType||j.nodeType!==1||l.attr("data-pressed")){l=null;return}var h=arguments,e=h.length;if(e==2&&(typeof h[1]!=="string"||c.isFunction(h[1]))){k=h[1];f=null}var d=l.attr("data-animate"),f=f||d,g=l.attr("data-animate-old");if(f===g){return}if(g&&l.hasClass(g)){l.removeClass(g)}l.attr("data-animate-old",f);l.attr("data-pressed","true").addClass(f).one(c.animateEnd_EV,function(){l.removeAttr("data-pressed");k&&k.call(this)})};c.fn.classCss3Animate=function(e,f){var d=this.length;if(!d){return this}if(arguments.length==1&&(typeof e!=="string"||c.isFunction(e))){f=e;e=null}this.each(function(h,g){c.classCss3Animate(this,e,(f&&function(){f.call(this)}))});return this}})($$$);(function(b){b.ui={}})($$$);(function(h){var d=function(){};var f={loading:false,autoHide:"",customClass:"",tipText:"",status:"hide",showCallBack:d,hideCallBack:d};var e=function(o){var l=document.getElementById("mask");var k=o.customClass.match(/\S+/g)||[];var j=k.length;var n={};if(!l){l=document.createElement("div");l.id="mask";l.classList.add("mask");document.documentElement.appendChild(l)}else{l.className="";l.classList.add("mask")}if(j){for(var m=0;m<j;m++){l.classList.add(k[m])}}l.innerHTML="";o.root=l;return b(o)};var b=function(j){var k=['<div class="mask-loading">','	<div class="mask-loading-conatiner">',"{%?it.tipText||it.loading%}",'		<div class="mask-loading-inner">','      	<div class="mask-inner-body">'," 				{%?it.loading%}",'					{%?it.loading=="shouxinerLoading"%}','						<div class="logo-loading-box">','							<div class="wave">','								<div class="inner"></div>',"							</div>",'							<div class="logo"></div>',"						</div>","					{%??%}",'				        <div class="loading-spinner-outer">','							<div class="loading-spinner">','								<span class="loading-top"></span>','								<span class="loading-right"></span>','								<span class="loading-bottom"></span>','								<span class="loading-left"></span>',"							</div>","						</div>","					{%?%}"," 				{%?%}",'				{%?it.tipText%}<div class="mask-tip-txt">{%=it.tipText%}</div>{%?%}',"			</div>","		</div>","{%?%}","	</div>","</div>"].join("");j.root.innerHTML=h.doT(k,j);j.loadingElem=j.root.querySelectorAll(".mask-loading")[0];return j};var c=function(l){var j,k=l.autoHide?(typeof l.autoHide=="number"?l.autoHide:parseInt(l.autoHide,10)):0;if(window.getComputedStyle(l.root)["display"]=="none"){l.root.style.display="block"}if((l.loading||l.tipText)&&l.loadingElem){l.loadingElem.style.display="block"}if(l.autoHide){j=setTimeout(function(){l.loadingElem.style[h.cssPrefix.prefix+"TransitionDuration"]="300ms";l.loadingElem.style[h.cssPrefix.prefix+"Transform"]="translateY(-100%)"},l.autoHide);h.one(l.loadingElem,h.transEnd_EV,function(){clearTimeout(j);l.root.style.display="none";l.showCallBack()})}else{l.showCallBack()}};var g=function(j){if(window.getComputedStyle(j.root)["display"]!=="none"){j.root.style.display="none"}if(j.loadingElem){j.loadingElem.style.display="none"}j.hideCallBack()};h.ui.mask=function(j){var k=h.extend({},f,j);k=e(k);if(k.status){c(k)}else{g(k)}};h.ui.mask.show=function(j,m){var l={loading:false,status:true,showCallBack:d};if(typeof j=="function"){m=j;l={loading:false,status:true,showCallBack:m}}else{if(j===null){l.loading=!!j}else{switch(typeof j){case"boolean":case"string":case"number":case"undefined":l.loading=!!j;break;case"object":l=h.extend(l,j);break}}}var k=h.extend({},f,l);k.status=true;this(k)};h.ui.mask.hide=function(j,m){var l={loading:false,status:false,hideCallBack:d};if(typeof j=="function"){m=j;l={loading:false,status:false,hideCallBack:m}}else{if(j===null){l.loading=!!j}else{switch(typeof j){case"boolean":case"string":case"number":case"undefined":l.loading=!!j;break;case"object":l=h.extend(l,j);break}}}var k=h.extend({},f,l);k.status=false;this(k)}})($$$);(function(l){var j=function(){},e=function(){},q=function(){},c={title:"提示信息",msg:"消息提示",type:"alert",txt:{okTxt:"确认",cancelTxt:"取消"},elem:f,customClass:{userClass:"",okClass:"",cancelClass:"",showAnimateClass:"bounce-in",hideAnimateClass:"bounce-out"},maskClass:"",callBack:{preInput:j,okFn:e,cancelFn:q}};var g={cancelBool:false,okBool:true},f={root:null,container:null,content:null,bodyBox:null,titleBox:null,msgBox:null,okBtn:null,cancelBtn:null},b=function(r){if(r.callBack.okFn){r.callBack.okFn.call(r.elem)}if(r.callBack.cancelFn){r.callBack.cancelFn.call(r.elem)}},k=function(t){var s=document.getElementById("msgbox");var r;var u;if(!s){var v=document.createElement("div");s=v.cloneNode(false);s.id="msgbox";s.style.zIndex=9999;s.classList.add("msgbox");r=v.cloneNode(false);r.classList.add("msgbox-container");u=v.cloneNode(false);u.classList.add("msgbox-content");s.appendChild(r);r.appendChild(u);document.documentElement.appendChild(s)}else{r=s.querySelectorAll(".msgbox-container")[0];u=s.querySelectorAll(".msgbox-content")[0]}s.className="";s.classList.add("msgbox");if(t.customClass.userClass){s.className="";s.classList.add("msgbox");s.classList.add(t.customClass.userClass)}f.root=s;f.container=r;f.content=u;return f},o=function(s){p(s);var r=l.touch_EV.start_EV;if(s.elem.okBtn){l.one(s.elem.okBtn,"click",function(t){t.stopPropagation();n(s,true)})}if(s.elem.cancelBtn){l.one(s.elem.cancelBtn,"click",function(t){t.stopPropagation();n(s,false)})}},p=function(s,r){if(window.getComputedStyle(s.elem.root)["display"]=="none"){l.ui.mask.show(function(){s.elem.root.style.display="block";if(s.customClass.showAnimateClass){l(s.elem.root).classCss3Animate(s.customClass.showAnimateClass,function(){this.classList.remove(s.customClass.showAnimateClass)})}})}if(s.callBack.preInput){s.callBack.preInput.call(s.elem)}},n=function(s,r){if(window.getComputedStyle(s.elem.root)["display"]!=="none"){if(s.customClass.hideAnimateClass){l(s.elem.root).classCss3Animate(s.customClass.hideAnimateClass,function(){s.elem.root.style.display="none";if(r===true){l.ui.mask.hide(function(){if(s.callBack.okFn){s.callBack.okFn.call(s.elem)}})}else{if(r===false){l.ui.mask.hide(function(){if(s.callBack.cancelFn){s.callBack.cancelFn.call(s.elem)}})}else{l.ui.mask.hide()}}this.classList.remove(s.customClass.hideAnimateClass)})}else{l.ui.mask.hide(function(){s.elem.root.style.display="none";if(r===true){if(s.callBack.okFn){s.callBack.okFn.call(s.elem)}}else{if(r===false){if(s.callBack.cancelFn){s.callBack.cancelFn.call(s.elem)}}else{l.ui.mask.hide()}}})}}},d=function(v){v.bool=g;var w=['<div class="msgbox-body">',' <span class="inner-bg">',' 	<span class="inner"><span class="inner2"></span></span>'," </span>",' <div class="msgbox-body-inner">','		<div class="msgbox-title">','			<span class="msg-title-txt">{%=it.title%}</span>',"		</div>",'		<div class="msgbox-msg">',"			{%=it.msg%}","		</div>",'		<div class="msgbox-buttons">',"			{%?it.bool.cancelBool%}",'				<button type="buttom" data-msgbox-btn="cancel" class="btn btn-sm btn-default {%?it.customClass.cancelClass%}{%=it.customClass.cancelClass%}{%?%}">{%=it.txt.cancelTxt%}</button>',"			{%?%}","			{%?it.bool.okBool%}",'				<button type="buttom" data-msgbox-btn="ok" class="btn btn-sm btn-warning {%?it.customClass.okClass%}{%=it.customClass.okClass%}{%?%}">','					<span class="btn-txt">{%=it.txt.okTxt%}</span>','					<div class="loading-spinner-outer">','						<div class="loading-spinner">','							<span class="loading-top"></span>','							<span class="loading-right"></span>','							<span class="loading-bottom"></span>','							<span class="loading-left"></span>',"						</div>","					</div>","				</button>","			{%?%}","		</div>","	</div>","</div>"].join("");v.elem.content.innerHTML=l.doT(w,v);v.elem.bodyBox=v.elem.content.querySelectorAll(".msgbox-body")[0];v.elem.titleBox=v.elem.content.querySelectorAll(".msgbox-title")[0];v.elem.msgBox=v.elem.content.querySelectorAll(".msgbox-msg")[0];var u=v.elem.content.querySelectorAll(".msgbox-buttons")[0].getElementsByTagName("button");for(var t=0,s=u.length;t<s;t++){var r=u[t].getAttribute("data-msgbox-btn");if(r){if(r=="ok"){v.elem.okBtn=u[t]}if(r=="cancel"){v.elem.cancelBtn=u[t]}}}delete v.bool;return v},m=function(u){var v=l.touch_EV.start_EV;var t=l.touch_EV.end_EV;l.one(u.elem.container,v,function(w){if(w.target==u.elem.container){u.elem.root.classList.add("txt-select-off")}});l.one(u.elem.container,t,function(w){u.elem.root.classList.remove("txt-select-off");if(w.target==u.elem.container){n(u);if(u.callBack.cancelFn){u.callBack.cancelFn.call(u.elem)}}});var r=function(w){if(w.keyCode===27){u.elem.root.classList.remove("txt-select-off");n(u);if(u.callBack.cancelFn){u.callBack.cancelFn.call(u.elem)}s(true)}};var s=function(y){var x=window.top;var A=x.document.getElementsByTagName("iframe");var w=A.length;var z=0;if(y){if(w){for(;z<w;z++){l.off(A[z].contentWindow,"keyup",r)}l.off(window,"keyup",r)}else{l.off(window,"keyup",r)}}else{if(w){for(;z<w;z++){l.on(A[z].contentWindow,"keyup",r)}l.on(window,"keyup",r)}else{l.on(window,"keyup",r)}}};s()};function h(){if(!f.root){return}f.root.style.display="none";l.mask.hide()}l.ui.msgbox=function(r){var r=l.extend({},c,r);r.elem=k(r);m(r);if(r.type=="alert"){g.cancelBool=false;g.okBool=true;o(d(r))}else{if(r.type=="confirm"){g.cancelBool=true;g.okBool=true;o(d(r))}}m(r);return this};l.ui.msgbox.hide=h})($$$);
